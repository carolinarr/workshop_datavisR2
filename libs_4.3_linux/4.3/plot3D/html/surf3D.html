<!DOCTYPE html><html><head><title>R: Functions for plotting 3 dimensional shapes</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body><div class="container">

<table style="width: 100%;"><tr><td>3-D surfaces {plot3D}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2 id='3-D+20surfaces'>
Functions for plotting 3 dimensional shapes
</h2>

<h3>Description</h3>

<p><code>surf3D</code> plots a surface in 3-D with a color variable.
</p>
<p><code>spheresurf3D</code> plots a colored image on a sphere.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>surf3D (x, y, z, ..., colvar = z, phi = 40, theta = 40,
        col = NULL, NAcol = "white", breaks = NULL,
        border = NA, facets = TRUE, colkey = NULL,
        panel.first = NULL, clim = NULL, clab = NULL, bty = "n",
        lighting = FALSE, shade = NA, ltheta = -135, lphi = 0,
        inttype = 1, add = FALSE, plot = TRUE)

spheresurf3D (colvar = matrix(nrow = 50, ncol = 50, data = 1:50, byrow = TRUE), 
        ..., phi = 0, theta = 0,
        col = NULL, NAcol = "white", breaks = NULL,
        border = NA, facets = TRUE, contour = FALSE,
        colkey = NULL, resfac = 1,
        panel.first = NULL, clim = NULL, clab = NULL, bty = "n", 
        lighting = FALSE, shade = NA, ltheta = -135, lphi = 0,
        inttype = 1, full = FALSE, add = FALSE, plot = TRUE) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="3-D+20surfaces_:_x">x</code>, <code id="3-D+20surfaces_:_y">y</code>, <code id="3-D+20surfaces_:_z">z</code></td>
<td>
<p>Matrices with x, y and z-values that define the surfaces to
be colored. They should be of the same dimension
as <code>colvar</code>.
</p>
</td></tr>
<tr><td><code id="3-D+20surfaces_:_colvar">colvar</code></td>
<td>
<p>The variable used for coloring. If a matrix, it should be of the same 
dimension as <code>x, y, z</code>.
Values of <code>NULL</code>, <code>NA</code>, or <code>FALSE</code>
will toggle off coloration according to <code>colvar</code>. This gives good results
only if <code>border</code> is given a color or a shade is used.
</p>
</td></tr>
<tr><td><code id="3-D+20surfaces_:_theta">theta</code>, <code id="3-D+20surfaces_:_phi">phi</code></td>
<td>
<p>the angles defining the viewing direction. 
<code>theta</code> gives the azimuthal direction and <code>phi</code> the colatitude. see <a href="../../graphics/html/persp.html">persp</a>.
</p>
</td></tr>
<tr><td><code id="3-D+20surfaces_:_col">col</code></td>
<td>
<p>Color palette to be used for coloring the <code>colvar</code> variable. 
If <code>col</code> is <code>NULL</code> and <code>colvar</code> is specified, 
then a red-yellow-blue colorscheme (<a href="../../plot3D/help/jet.col.html">jet.col</a>) will be used.
If <code>col</code> is <code>NULL</code> and <code>colvar</code> is not specified, then 
<code>col</code> will be &quot;grey&quot;. 
</p>
</td></tr>
<tr><td><code id="3-D+20surfaces_:_NAcol">NAcol</code></td>
<td>
<p>Colors to be used for <code>colvar</code> values that are <code>NA</code>.
</p>
</td></tr>
<tr><td><code id="3-D+20surfaces_:_breaks">breaks</code></td>
<td>
<p>a set of finite numeric breakpoints for the colors;
must have one more breakpoint than color and be in increasing order.
Unsorted vectors will be sorted, with a warning.
</p>
</td></tr>
<tr><td><code id="3-D+20surfaces_:_border">border</code></td>
<td>
<p>The color of the lines drawn around the surface facets.
The default, <code>NA</code>, will disable the drawing of borders.
</p>
</td></tr>
<tr><td><code id="3-D+20surfaces_:_facets">facets</code></td>
<td>
<p>If <code>TRUE</code>, then <code>col</code> denotes the color of the surface facets. 
If <code>FALSE</code>, then the surface facets are colored &ldquo;white&rdquo; and the <code>border</code> 
(if <code>NA</code>) will be colored as specified by <code>col</code>. 
If <code>NA</code> then the facets will be transparent. 
It is usually faster to draw with <code>facets = FALSE</code>.
</p>
</td></tr>
<tr><td><code id="3-D+20surfaces_:_contour">contour</code></td>
<td>
<p>If <code>TRUE</code>, then a <a href="../../graphics/html/contour.html">contour</a> plot will be 
added to the image plot, unless <code>x, y</code> are a matrix. 
Also allowed is to pass a <code>list</code> with arguments for the 
<a href="../../graphics/html/contour.html">contour</a> function. 
</p>
</td></tr>
<tr><td><code id="3-D+20surfaces_:_colkey">colkey</code></td>
<td>
<p>A logical, <code>NULL</code> (default), or a <code>list</code> with parameters 
for the color key (legend). List parameters should be one of 
<code>side, plot, length, width, dist, shift, addlines, col.clab, cex.clab,
      side.clab, line.clab, adj.clab, font.clab</code>
and the axis parameters <code>at, labels, tick, line, pos, outer, font, lty, lwd,
    lwd.ticks, col.box, col.axis, col.ticks, hadj, padj, cex.axis, mgp, tck, tcl, las</code>.
The defaults for the parameters are <code>side = 4, plot = TRUE, length = 1, width = 1, 
      dist = 0, shift = 0, addlines = FALSE, col.clab = NULL, cex.clab = par("cex.lab"), 
      side.clab = NULL, line.clab = NULL, adj.clab = NULL, font.clab = NULL</code>)
See <a href="../../plot3D/help/colkey.html">colkey</a>.
</p>
<p>The default is to draw the color key on side = 4, i.e. in the right margin.
If <code>colkey</code> = <code>NULL</code> then a color key will be added only if <code>col</code> is a vector.
Setting <code>colkey = list(plot = FALSE)</code> will create room for the color key 
without drawing it.
if <code>colkey = FALSE</code>, no color key legend will be added.
</p>
</td></tr> 
<tr><td><code id="3-D+20surfaces_:_resfac">resfac</code></td>
<td>
<p>Resolution factor, one value or a vector of two numbers, for 
the x and y- values respectively. A value &gt; 1 will increase the 
resolution. For instance, if <code>resfac</code> equals <code>3</code> then for each 
adjacent pair of x- and y-values, z will be interpolated to two intermediary points. 
This uses simple linear interpolation. If <code>resfac</code> is one number then
the resolution will be increased similarly in x and y-direction.  
</p>
</td></tr>
<tr><td><code id="3-D+20surfaces_:_panel.first">panel.first</code></td>
<td>
<p>A <code>function</code> to be evaluated after the plot axes are 
set up but before any plotting takes place. 
This can be useful for drawing background grids or scatterplot smooths. 
The function should have as argument the transformation matrix, e.g. it should
be defined as <code>function(pmat)</code>. See example of <a href="../../plot3D/help/persp3D.html">persp3D</a> and last example of <a href="../../plot3D/help/voxel3D.html">voxel3D</a>.
</p>
</td></tr> 
<tr><td><code id="3-D+20surfaces_:_clab">clab</code></td>
<td>
<p>Only if <code>colkey</code> is not <code>NULL</code> or <code>FALSE</code>, 
the label to be written on top of the color key. 
The label will be written at the same level as the main title.
To lower it, <code>clab</code> can be made a vector, with the first values empty 
strings. 
</p>
</td></tr> 
<tr><td><code id="3-D+20surfaces_:_clim">clim</code></td>
<td>
<p>Only if <code>colvar</code> is specified, the range of the color variable, used
for the color key.  Values of <code>colvar</code> that extend the range will be put to <code>NA</code>.
</p>
</td></tr> 
<tr><td><code id="3-D+20surfaces_:_bty">bty</code></td>
<td>
<p>The type of the box, the default is to draw no box.
Set <code>bty = "f"</code> or <code>bty = "b"</code> if you want a full box or the backpanel.
See <a href="../../plot3D/help/perspbox.html">perspbox</a>.
</p>
</td></tr>
<tr><td><code id="3-D+20surfaces_:_lighting">lighting</code></td>
<td>
<p>If not <code>FALSE</code> the facets will be illuminated, and colors may
appear more bright. To switch on lighting, the argument <code>lighting</code> 
should be either set to <code>TRUE</code> (using default settings) or it can be a 
list with specifications of one of the following: 
<code>ambient, diffuse, specular, exponent, sr</code> and <code>alpha</code>. 
</p>
<p>Will overrule <code>shade</code> not equal to <code>NA</code>.
</p>
<p>See examples in <a href="../../plot3D/help/jet.col.html">jet.col</a>.
</p>
</td></tr> 
<tr><td><code id="3-D+20surfaces_:_shade">shade</code></td>
<td>
<p>the degree of shading of the surface facets. 
Values of shade close to one yield shading similar to a point light 
source model and values close to zero produce no shading. 
Values in the range 0.5 to 0.75 provide an approximation to daylight illumination.
See <a href="../../graphics/html/persp.html">persp</a>.
</p>
</td></tr> 
<tr><td><code id="3-D+20surfaces_:_ltheta">ltheta</code>, <code id="3-D+20surfaces_:_lphi">lphi</code></td>
<td>
<p>if finite values are specified for <code>ltheta</code> and 
<code>lphi</code>, the surface is shaded as though it was being illuminated from 
the direction specified by azimuth <code>ltheta</code> and colatitude <code>lphi</code>.
See <a href="../../graphics/html/persp.html">persp</a>.
</p>
</td></tr>
<tr><td><code id="3-D+20surfaces_:_inttype">inttype</code></td>
<td>
<p>The interpolation type to create the polygons, either 
taking the mean of the <code>colvar</code> variable (<code>inttype = 1, 3</code> or 
extending the <code>x, y, z</code> values (<code>inttype = 2</code>). 
Values <code>1, 3</code> differ in how they treat <code>NA</code>s in the <code>colvar</code> variable. 
For <code>inttype = 3</code>, <code>NA</code>s are removed before taking averages; 
this will tend to make the <code>NA</code> region smaller. 
<code>NA</code>s are included when <code>inttype = 1</code>. This will tend to make the <code>NA</code> region larger.
See details and an example in <a href="../../plot3D/help/persp3D.html">persp3D</a>.
</p>
</td></tr> 
<tr><td><code id="3-D+20surfaces_:_full">full</code></td>
<td>
<p>Logical. If <code>TRUE</code>, the full sphere will be drawn, including the 
invisible part. If <code>FALSE</code> only the visible half will be drawn (faster). 
</p>
</td></tr> 
<tr><td><code id="3-D+20surfaces_:_add">add</code></td>
<td>
<p>Logical. If <code>TRUE</code>, then the surfaces will be added to the current plot.
If <code>FALSE</code> a new plot is started. 
</p>
</td></tr> 
<tr><td><code id="3-D+20surfaces_:_plot">plot</code></td>
<td>
<p>Logical. If <code>TRUE</code> (default), a plot is created, 
otherwise the viewing transformation matrix is returned (as invisible). 
</p>
</td></tr> 
<tr><td><code id="3-D+20surfaces_:_...">...</code></td>
<td>
<p>Additional arguments passed to the plotting methods. 
The following <a href="../../graphics/html/persp.html">persp</a> arguments can be specified: 
<code>xlim, ylim, zlim, xlab, ylab, zlab, main, sub, r, d, 
    scale, expand, box, axes, nticks, ticktype</code>.      
The arguments <code>xlim</code>, <code>ylim</code>, <code>zlim</code> only affect the axes.
All objects will be plotted, including those that fall out of these ranges.
To select objects only within the axis limits, use <a href="../../plot3D/help/plotdev.html">plotdev</a>.
</p>
<p>In addition, the <a href="../../plot3D/help/perspbox.html">perspbox</a> arguments
<code>col.axis, col.panel, lwd.panel, col.grid, lwd.grid</code> can 
also be given a value.
The arguments after ... must be matched exactly.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Function <code>spheresurf3D</code> is a projection on a sphere with radius 1.
This means that the x- y- and z- axes range from [-1, 1].
</p>


<h3>Value</h3>

<p>Returns the viewing transformation matrix,
See <a href="../../plot3D/help/trans3D.html">trans3D</a>.
</p>


<h3>Author(s)</h3>

<p>Karline Soetaert &lt;karline.soetaert@nioz.nl&gt;</p>


<h3>See Also</h3>

<p><a href="../../graphics/html/persp.html">persp</a> for the function on which this implementation is based.
</p>
<p><a href="../../plot3D/help/jet.col.html">jet.col</a>, <a href="../../plot3D/help/plotdev.html">plotdev</a> for other examples of <code>surf3D</code>.
</p>
<p><a href="../../plot3D/help/plotdev.html">plotdev</a> for zooming, rescaling, rotating a plot.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># save plotting parameters
 pm   &lt;- par("mfrow")
 pmar &lt;- par("mar")

 par(mar = c(1, 1, 1, 1))

## =======================================================================
## A three-dimensional shape 
## (ala http://docs.enthought.com/mayavi/mayavi/mlab.html)
## =======================================================================

 par(mfrow = c(2, 2))
# create grid matrices
 X       &lt;- seq(0, pi, length.out = 50)
 Y       &lt;- seq(0, 2*pi, length.out = 50)
 M       &lt;- mesh(X, Y)
 phi     &lt;- M$x
 theta   &lt;- M$y

# x, y and z grids
 r &lt;- sin(4*phi)^3 + cos(2*phi)^3 + sin(6*theta)^2 + cos(6*theta)^4
 x &lt;- r * sin(phi) * cos(theta)
 y &lt;- r * cos(phi)
 z &lt;- r * sin(phi) * sin(theta)

# full colored image
 surf3D(x, y, z, colvar = y, colkey = FALSE, shade = 0.5,
        box = FALSE, theta = 60)

# same, but just facets
 surf3D(x, y, z, colvar = y, colkey = FALSE, box = FALSE, 
        theta = 60, facets = FALSE)

# with colors and border, AND increasing the size
# (by reducing the x- y and z- ranges
 surf3D(x, y, z, colvar = y, colkey = FALSE, box = FALSE, 
        theta = 60, border = "black", xlim = range(x)*0.8, 
        ylim = range(y)*0.8, zlim = range(z)*0.8)

# Now with one color and shading
 surf3D(x, y, z, box = FALSE,
        theta = 60, col = "lightblue", shade = 0.9)

## Not run:  # rotation
  for (angle in seq(0, 360, by = 10))
    plotdev(theta = angle)


## End(Not run)

## =======================================================================
## Several other shapes 
## http://xahlee.info/surface/gallery.html
## =======================================================================

 par(mfrow = c(2, 2)) 
 # Shape 1
 M  &lt;- mesh(seq(0,  6*pi, length.out = 50), 
            seq(pi/3, pi, length.out = 50))
 u  &lt;- M$x ; v &lt;- M$y

 x &lt;- u/2 * sin(v) * cos(u)
 y &lt;- u/2 * sin(v) * sin(u)
 z &lt;- u/2 * cos(v)

 surf3D(x, y, z, colvar = z, colkey = FALSE, box = FALSE, phi = 50)

# Shape 2: add border
 M  &lt;- mesh(seq(0, 2*pi, length.out = 50), 
            seq(0, 2*pi, length.out = 50))
 u  &lt;- M$x ; v  &lt;- M$y

 x  &lt;- sin(u)
 y  &lt;- sin(v)
 z  &lt;- sin(u + v)

 surf3D(x, y, z, colvar = z, border = "black", 
        colkey = FALSE)

# shape 3: uses same mesh, other perspective (d &gt;1)
 x &lt;- (3 + cos(v/2)*sin(u) - sin(v/2)*sin(2*u))*cos(v)
 y &lt;- (3 + cos(v/2)*sin(u) - sin(v/2)*sin(2*u))*sin(v)
 z &lt;- sin(v/2)*sin(u) + cos(v/2)*sin(2*u)

 surf3D(x, y, z, colvar = z, colkey = FALSE, d = 2, facets = FALSE)

# shape 4: more complex colvar
 M  &lt;- mesh(seq(-13.2, 13.2, length.out = 50), 
            seq(-37.4, 37.4, length.out = 50))
 u  &lt;- M$x   ; v &lt;- M$y

 b &lt;- 0.4; r &lt;- 1 - b^2; w &lt;- sqrt(r)
 D &lt;- b*((w*cosh(b*u))^2 + (b*sin(w*v))^2)
 x &lt;- -u + (2*r*cosh(b*u)*sinh(b*u)) / D
 y &lt;- (2*w*cosh(b*u)*(-(w*cos(v)*cos(w*v)) - sin(v)*sin(w*v))) / D
 z &lt;- (2*w*cosh(b*u)*(-(w*sin(v)*cos(w*v)) + cos(v)*sin(w*v))) / D

 surf3D(x, y, z, colvar = sqrt(x + 8.3), colkey = FALSE, 
        theta = 10, border = "black", box = FALSE)
 box()

## =======================================================================
## A sphere, with box type with grid lines
## =======================================================================

 par(mar = c(2, 2, 2, 2))
 par(mfrow = c(1, 1))
 M  &lt;- mesh(seq(0, 2*pi, length.out = 50), 
            seq(0,   pi, length.out = 50))
 u  &lt;- M$x ; v  &lt;- M$y

 x &lt;- cos(u)*sin(v)
 y &lt;- sin(u)*sin(v)
 z &lt;- cos(v)

 colvar &lt;- sin(u*6) * sin(v*6)

 surf3D(y, x, z, colvar = colvar, phi = 0, bty = "b2", 
        lighting = TRUE, ltheta = 40)

## =======================================================================
## Function spheresurf3D
## =======================================================================

 par(mfrow = c(2, 2))
 spheresurf3D()
 
# true ranges are [-1, 1]; set limits to [-0.8, 0.8] to make larger plots
 lim &lt;- c(-0.8, 0.8)
 spheresurf3D(colkey = FALSE, xlim = lim, ylim = lim, zlim = lim)

 spheresurf3D(bty = "b", ticktype = "detailed", phi = 50)
 spheresurf3D(colvar = matrix(nrow = 30, ncol = 30, data = runif(900)))
 
## =======================================================================
## Images on a sphere
## =======================================================================

 par(mfrow = c(1, 1), mar = c(1, 1, 1, 3))

 AA &lt;- Hypsometry$z; AA[AA&lt;=0] &lt;- NA
 
 lim &lt;- c(-0.8, 0.8)

# log transformation of color variable
 spheresurf3D(AA, NAcol = "black", theta = 90, phi = 30, box = FALSE,
   xlim = lim, ylim = lim, zlim = lim, log = "c")

# restore plotting parameters
 par(mfrow = pm)
 par(mar = pmar)
</code></pre>

<hr /><div style="text-align: center;">[Package <em>plot3D</em> version 1.4 <a href="00Index.html">Index</a>]</div>
</div>
</body></html>
