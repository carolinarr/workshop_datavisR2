<!DOCTYPE html><html><head><title>R: Contours in 3-D plots.</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body><div class="container">

<table style="width: 100%;"><tr><td>3-D contours {plot3D}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2 id='3-D+20contours'>
Contours in 3-D plots.
</h2>

<h3>Description</h3>

<p><code>contour3D</code> adds a <a href="../../graphics/html/contour.html">contour</a> in a 3-D plot. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>contour3D (x = NULL, y = NULL, z = NULL, 
       ..., colvar = NULL, phi = 40, theta = 40,
       col = NULL, colkey = NULL, 
       panel.first = NULL, clim = NULL, clab = NULL, bty = "b", 
       dDepth = 1e-1, addbox = TRUE, add = FALSE, plot = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="3-D+20contours_:_x">x</code>, <code id="3-D+20contours_:_y">y</code>, <code id="3-D+20contours_:_z">z</code></td>
<td>
<p>Matrix (2-D), vector, or one value containing the values 
where the image is to be plotted. 
At least one of them should be one number, as this will determine where the 
image is plotted, parallel to the (y-z) plane (x one number), 
to the (x-z) plane (y one number) or to the (z-y) plane (z one number).
</p>
<p>If two are vectors, the first vector should be of length equal to 
<code>nrow(colvar)</code> and the second should be of length equal to 
<code>ncol(colvar)</code>. 
</p>
</td></tr>
<tr><td><code id="3-D+20contours_:_colvar">colvar</code></td>
<td>
<p>The variable used for coloring. 
Values of <code>colvar</code> equal to <code>NULL</code>, <code>NA</code>, or <code>FALSE</code>
will toggle off coloration according to <code>colvar</code>. This gives good results
only if <code>border</code> is given a color, or when <code>shade</code> is &gt;0 (see <a href="../../graphics/html/persp.html">persp</a>).
</p>
</td></tr>
<tr><td><code id="3-D+20contours_:_col">col</code></td>
<td>
<p>Color palette to be used for the <code>colvar</code> variable.
If <code>col</code> is <code>NULL</code> and <code>colvar</code> is specified, 
then a red-yellow-blue colorscheme (<a href="../../plot3D/help/jet.col.html">jet.col</a>) will be used.
If <code>col</code> is <code>NULL</code> and <code>colvar</code> is not specified, then 
<code>col</code> will be &quot;black&quot;. 
</p>
</td></tr>
<tr><td><code id="3-D+20contours_:_colkey">colkey</code></td>
<td>
<p>A logical, <code>NULL</code> (default), or a <code>list</code> with parameters 
for the color key (legend). List parameters should be one of 
<code>side, plot, length, width, dist, shift, addlines, col.clab, cex.clab,
      side.clab, line.clab, adj.clab, font.clab</code>
and the axis parameters <code>at, labels, tick, line, pos, outer, font, lty, lwd,
    lwd.ticks, col.box, col.axis, col.ticks, hadj, padj, cex.axis, mgp, tck, tcl, las</code>.
The defaults for the parameters are <code>side = 4, plot = TRUE, length = 1, width = 1, 
      dist = 0, shift = 0, addlines = FALSE, col.clab = NULL, cex.clab = par("cex.lab"), 
      side.clab = NULL, line.clab = NULL, adj.clab = NULL, font.clab = NULL</code>)
See <a href="../../plot3D/help/colkey.html">colkey</a>.
</p>
<p>The default is to draw the color key on side = 4, i.e. in the right margin.
If <code>colkey</code> = <code>NULL</code> then a color key will be added only if <code>col</code> is a vector.
Setting <code>colkey = list(plot = FALSE)</code> will create room for the color key 
without drawing it.
if <code>colkey = FALSE</code>, no color key legend will be added.
</p>
</td></tr>  
<tr><td><code id="3-D+20contours_:_clab">clab</code></td>
<td>
<p>Only if <code>colkey = TRUE</code>, the label to be written on top of the
color key. The label will be written at the same level as the main title.
to lower it, <code>clab</code> can be made a vector, with the first values empty 
strings. 
</p>
</td></tr> 
<tr><td><code id="3-D+20contours_:_clim">clim</code></td>
<td>
<p>Only if <code>colvar</code> is specified, the range of the color variable, used
for the color key. Values of <code>colvar</code> that extend the range will be put to <code>NA</code>.
</p>
</td></tr> 
<tr><td><code id="3-D+20contours_:_theta">theta</code>, <code id="3-D+20contours_:_phi">phi</code></td>
<td>
<p>The angles defining the viewing direction. 
<code>theta</code> gives the azimuthal direction and <code>phi</code> the colatitude. 
see <a href="../../graphics/html/persp.html">persp</a>.
</p>
</td></tr>
<tr><td><code id="3-D+20contours_:_panel.first">panel.first</code></td>
<td>
<p>A <code>function</code> to be evaluated after the plot axes are 
set up but before any plotting takes place. 
This can be useful for drawing background grids or scatterplot smooths. 
The function should have as argument the transformation matrix, e.g. it should
be defined as <code>function(pmat)</code>. See example of <a href="../../plot3D/help/persp3D.html">persp3D</a> and last example of <a href="../../plot3D/help/voxel3D.html">voxel3D</a>.
</p>
</td></tr> 
<tr><td><code id="3-D+20contours_:_bty">bty</code></td>
<td>
<p>The type of the box, the default only drawing background panels.
Only effective if the <a href="../../graphics/html/persp.html">persp</a> 
argument (<code>box</code>) equals <code>TRUE</code> (this is the default). See <a href="../../plot3D/help/perspbox.html">perspbox</a>.
</p>
</td></tr>
<tr><td><code id="3-D+20contours_:_dDepth">dDepth</code></td>
<td>
<p>When a contour is added on an image, the image polygons may
hide some contour segments. To avoid that, the viewing depth of the segments
can be artificially decreased with the factor <code>dDepth</code> times the 
<a href="../../graphics/html/persp.html">persp</a> argument <code>expand</code> (usually = 1), to make them 
appear in front of the polygons. Too large values of <code>dDepth</code> 
may create visible artifacts.
</p>
</td></tr>   
<tr><td><code id="3-D+20contours_:_addbox">addbox</code></td>
<td>
<p>If <code>TRUE</code> will draw a box around the
plot.
</p>
</td></tr>   
<tr><td><code id="3-D+20contours_:_add">add</code></td>
<td>
<p>Logical. If <code>TRUE</code>, then the contours will be added to the current plot.
If <code>FALSE</code> a new plot is started. 
</p>
</td></tr> 
<tr><td><code id="3-D+20contours_:_plot">plot</code></td>
<td>
<p>Logical. If <code>TRUE</code> (default), a plot is created, 
otherwise the viewing transformation matrix is returned (as invisible). 
</p>
</td></tr> 
<tr><td><code id="3-D+20contours_:_...">...</code></td>
<td>
<p>additional arguments passed to the plotting methods. 
</p>
<p>The following <a href="../../graphics/html/persp.html">persp</a> arguments can be specified: 
<code>xlim, ylim, zlim, xlab, ylab, zlab, main, sub, r, d, 
    scale, expand, box, axes, nticks, ticktype</code>.      
The arguments <code>xlim</code>, <code>ylim</code>, <code>zlim</code> only affect the axes.
All objects will be plotted, including those that fall out of these ranges.
To select objects only within the axis limits, use <a href="../../plot3D/help/plotdev.html">plotdev</a>.
</p>
<p>In addition, the <a href="../../plot3D/help/perspbox.html">perspbox</a> arguments
<code>col.axis, col.panel, lwd.panel, col.grid, lwd.grid</code> can 
also be given a value.
</p>
<p>The arguments <code>lty, lwd</code> can also be specified.
</p>
<p><code>shade</code> and <code>lighting</code> arguments will have no effect.
</p>
<p><code>alpha</code> can be given a value inbetween 0 and 1 to make colors transparent.
</p>
<p>The arguments after ... must be matched exactly.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns the viewing transformation matrix.
See <a href="../../plot3D/help/trans3D.html">trans3D</a>.
</p>


<h3>Author(s)</h3>

<p>Karline Soetaert &lt;karline.soetaert@nioz.nl&gt;
</p>


<h3>See Also</h3>

<p><a href="../../graphics/html/contour.html">contour</a> for R's 2-D contour function.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># save plotting parameters
 pm &lt;- par("mfrow")

## =======================================================================
## Contours
## =======================================================================
 par (mfrow = c(2, 2))

 r &lt;- 1:nrow(volcano)
 c &lt;- 1:ncol(volcano)
 contour3D(x = r, y = c, z = 100, colvar = volcano, zlim = c(0, 150),
   clab = c("height", "m"))

 contour3D(x = 100, y = r, z = c, colvar = volcano, clab = c("height", "m"))

 contour3D(z = volcano, colvar = volcano, lwd = 2, 
   nlevels = 20, clab = c("height", "m"), colkey = FALSE)

 contour3D(y = volcano, colvar = volcano, lwd = 2, 
   nlevels = 10, clab = c("height", "m"))

## =======================================================================
## Composite images and contours in 3D
## =======================================================================
 persp3D(z = volcano, zlim = c(90, 300), col = "white", 
         shade = 0.1, d = 2, plot = FALSE)
 contour3D(z = volcano, colvar = volcano, lwd = 2, add = TRUE, 
         nlevels = 20, clab = c("height", "m"), plot = FALSE,
         colkey = list(at = seq(90, 190, length.out = 5)))
 contour3D(z = 300, colvar = volcano, lwd = 2, col = "grey",
         add = TRUE, nlevels = 5)
          
## =======================================================================
## the viewing depth of contours (dDepth)
## =======================================================================

# too low
 persp3D(z = volcano, col = "white", shade = 0.1, plot = FALSE)
 contour3D(z = volcano, colvar = volcano, lwd = 2, 
         add = TRUE, dDepth = 0, col = "black")

# default
 persp3D(z = volcano, col = "white", shade = 0.1, plot = FALSE)
 contour3D(z = volcano, colvar = volcano, lwd = 2, 
         add = TRUE, dDepth = 0.1, col = "black")

# too high
 persp3D(z = volcano, col = "white", shade = 0.1, plot = FALSE)
 contour3D(z = volcano, colvar = volcano, lwd = 1, 
         add = TRUE, dDepth = 0.5, col = "black")

# reset plotting parameters
 par(mfrow = pm)
</code></pre>

<hr /><div style="text-align: center;">[Package <em>plot3D</em> version 1.4 <a href="00Index.html">Index</a>]</div>
</div>
</body></html>
