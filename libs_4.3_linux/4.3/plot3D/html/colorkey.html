<!DOCTYPE html><html><head><title>R: Plots a color legend</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body><div class="container">

<table style="width: 100%;"><tr><td>Color key legend {plot3D}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2 id='Color+20key+20legend'>
Plots a color legend
</h2>

<h3>Description</h3>

<p><code>colkey</code> plots a color legend, either to an existing plot or starting
a new plot. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>colkey (col = NULL, clim, clab = NULL, clog = FALSE, add = FALSE, 
        cex.clab = NULL, col.clab = NULL, side.clab = NULL, 
        line.clab = NULL, adj.clab = NULL, font.clab = NULL,
        side = 4, length = 1, width = 1, dist = 0, shift = 0,
        addlines = FALSE, breaks = NULL, at = NULL, labels = TRUE, tick = TRUE,
        line = NA, pos = NA, outer = FALSE, font = NA, lty = 1, lwd = 1, 
        lwd.ticks = 1, col.axis = NULL, col.ticks = NULL, col.box = NULL,
        hadj = NA, padj = NA, cex.axis = par("cex.axis"),
        mgp = NULL, tck = NULL, tcl = NULL, las = NULL) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Color+20key+20legend_:_col">col</code></td>
<td>
<p>Colors to be used for the color key.
If <code>col</code> is <code>NULL</code>, 
then a red-yellow-blue colorscheme (<code>jet.col</code>) will be used.
</p>
</td></tr>
<tr><td><code id="Color+20key+20legend_:_clim">clim</code></td>
<td>
<p>The range of the color values, used in the color key. 
</p>
</td></tr> 
<tr><td><code id="Color+20key+20legend_:_clab">clab</code></td>
<td>
<p>The label to be written on top of the color key. 
The label will be written at the same level as the main title.
To lower it, either <code>clab</code> can be made a vector, with the first values empty 
strings. Alternatively, it can be lowered by argument <code>line.clab</code>.
</p>
</td></tr> 
<tr><td><code id="Color+20key+20legend_:_clog">clog</code></td>
<td>
<p>If <code>TRUE</code>, then values of the color key will be log transformed.
</p>
</td></tr> 
<tr><td><code id="Color+20key+20legend_:_add">add</code></td>
<td>
<p>If <code>TRUE</code>, the color key will be added to the current plot and
positioned in the margin. If <code>FALSE</code> a new plot will be started and the color
key will be positioned in the centre.
</p>
</td></tr> 
<tr><td><code id="Color+20key+20legend_:_cex.clab">cex.clab</code></td>
<td>
<p>The size of the label 
written on top of the color key; default = same as axis labels. 
</p>
</td></tr> 
<tr><td><code id="Color+20key+20legend_:_col.clab">col.clab</code></td>
<td>
<p>The color of the label 
written on top of the color key; default = same as main title. 
</p>
</td></tr> 
<tr><td><code id="Color+20key+20legend_:_side.clab">side.clab</code></td>
<td>
<p>The side of the label 
written on top of the color key; default = same as main title, i.e. side = 3. 
Values of 1, 2, 4 will put the colorkey label at bottom, left and right of the key respectively.     
</p>
</td></tr> 
<tr><td><code id="Color+20key+20legend_:_line.clab">line.clab</code></td>
<td>
<p>The numer of lines in the margin where the colorkey title is to be drawn.
If unspecified, it is at line.clab =1.75.
</p>
</td></tr> 
<tr><td><code id="Color+20key+20legend_:_adj.clab">adj.clab</code></td>
<td>
<p>The adjustment of the colorkey title, 
a number inbetween 0 (left) to 1 (right). The default is to put it central. 
</p>
</td></tr> 
<tr><td><code id="Color+20key+20legend_:_font.clab">font.clab</code></td>
<td>
<p>The font of the colorkey title, 
a number inbetween 0 (left) to 1 (right). The default is to put it central. 
</p>
</td></tr> 
<tr><td><code id="Color+20key+20legend_:_side">side</code></td>
<td>
<p>Where to put the color key. 1 = bottom, 2 = left, 3 = top, 4 = right.
</p>
</td></tr> 
<tr><td><code id="Color+20key+20legend_:_length">length</code></td>
<td>
<p>Relative length of the color key; 1 = same length as the axis.
</p>
</td></tr> 
<tr><td><code id="Color+20key+20legend_:_width">width</code></td>
<td>
<p>Relative width of the color key.
</p>
</td></tr> 
<tr><td><code id="Color+20key+20legend_:_dist">dist</code></td>
<td>
<p>Distance of the color key to the margin. 
Positive values are further into the margin, negative values cause the color key
to be positioned closer to or within the main plot. Reasonable range is [-0.5, 0.05].
</p>
</td></tr> 
<tr><td><code id="Color+20key+20legend_:_shift">shift</code></td>
<td>
<p>Shift relative to the centre. 
Positive values are upward when side = 2 or 4, and to the right for side = 1 or 3.
It does not make sense to use this argument if <code>length = 1</code>. 
Reasonable range is [-0.2, 0.2].
</p>
</td></tr> 
<tr><td><code id="Color+20key+20legend_:_addlines">addlines</code></td>
<td>
<p>If <code>TRUE</code>, will draw lines inbetween the colors.
</p>
</td></tr> 
<tr><td><code id="Color+20key+20legend_:_breaks">breaks</code></td>
<td>
<p>a set of finite numeric breakpoints for the colors;
must have one more breakpoint than color and be in increasing order.
Unsorted vectors will be sorted, with a warning.
</p>
</td></tr>
<tr><td><code id="Color+20key+20legend_:_at">at</code>, <code id="Color+20key+20legend_:_labels">labels</code>, <code id="Color+20key+20legend_:_tick">tick</code>, <code id="Color+20key+20legend_:_line">line</code>, <code id="Color+20key+20legend_:_pos">pos</code>, <code id="Color+20key+20legend_:_outer">outer</code>, <code id="Color+20key+20legend_:_font">font</code>, <code id="Color+20key+20legend_:_lty">lty</code>, <code id="Color+20key+20legend_:_lwd">lwd</code></td>
<td>
<p>Additional parameters
as from the <a href="../../graphics/html/axis.html">axis</a> command.
</p>
</td></tr> 
<tr><td><code id="Color+20key+20legend_:_lwd.ticks">lwd.ticks</code>, <code id="Color+20key+20legend_:_hadj">hadj</code>, <code id="Color+20key+20legend_:_padj">padj</code>, <code id="Color+20key+20legend_:_cex.axis">cex.axis</code>, <code id="Color+20key+20legend_:_mgp">mgp</code>, <code id="Color+20key+20legend_:_tck">tck</code>, <code id="Color+20key+20legend_:_tcl">tcl</code>, <code id="Color+20key+20legend_:_las">las</code></td>
<td>
<p>Additional parameters 
as from the <a href="../../graphics/html/axis.html">axis</a> command.
</p>
</td></tr> 
<tr><td><code id="Color+20key+20legend_:_col.box">col.box</code>, <code id="Color+20key+20legend_:_col.axis">col.axis</code>, <code id="Color+20key+20legend_:_col.ticks">col.ticks</code></td>
<td>
<p>Additional parameters 
to set the color of the color legend framing <code>box</code>, 
the axis label and the axis ticks.
</p>
</td></tr> 
</table>


<h3>Author(s)</h3>

<p>Karline Soetaert &lt;karline.soetaert@nioz.nl&gt;</p>


<h3>Examples</h3>

<pre><code class='language-R'># save plotting parameters
 pm &lt;- par(mfrow = c(2, 2))
 pmar &lt;- par(mar = c(5.1, 4.1, 4.1, 2.1))

## =======================================================================
##  colorkey as argument of a plot3D function
## =======================================================================
# default, colkey = NULL: adds colkey because multiple colors
 image2D(z = volcano)  

# default, colkey = NULL: no colkey because only one color
 image2D(z = volcano, col = "grey", shade = 0.2, contour = TRUE)  

# colkey = FALSE: no color key, no extra space foreseen
 image2D(z = volcano, colkey = FALSE)
 
# colkey = list(plot = FALSE): no color key, extra space foreseen
 image2D(z = volcano, colkey = list(plot = FALSE, side = 3))
 colkey (side = 3, add = TRUE, clim = range(volcano))
 
 
## =======================================================================
##  colorkey in new plot
## =======================================================================
 
 colkey(side = 1, clim = c(0, 1), add = FALSE, clab = "z", 
   col.clab = "red", adj.clab = 0)
 colkey(side = 2, clim = c(0, 1), clab = "z", length = 0.5, width = 0.5)
 colkey(side = 3, clim = c(0, 1), lwd = 3, clab = c("a","b","c","d"), 
   line.clab = 5)
 colkey(side = 4, clim = c(1e-6, 1), clog = TRUE, 
   clab = "a very long title in bold and close to the key", 
   line.clab = 1, side.clab = 2, font.clab = 2)

## =======================================================================
##  colorkey added to existing plot
## =======================================================================

 par(mfrow = c(1, 1))

 image2D(volcano, xlab = "", clab = "m", 
       colkey = list(side = 1, length = 0.5, width = 0.5, 
         line.clab = 1))
 colkey(side = 3, clim = range(volcano), add = TRUE)

# 'dist' to put colkey within the image 
# 'shift' to position colkey to the right or upward
 par(mfrow = c(1, 1))
 image2D(volcano, colkey = FALSE)

 colkey(clim = range(volcano), dist = -0.15, shift = 0.2,
        side = 3, add = TRUE, clab = "key 1", col.clab = "white",
        length = 0.5, width = 0.5, col.axis = "white", 
        col.ticks = "white", cex.axis = 0.8)

 colkey(clim = range(volcano), dist = -0.1, shift = -0.2,
        side = 4, add = TRUE, clab = "key 2", col.clab = "white",
        length = 0.3, width = 0.5, col.axis = "white", 
        col.ticks = "white", col.box = "red", cex.axis = 0.8)

 colkey(clim = range(volcano), dist = -0.3, 
        side = 1, add = TRUE, clab = "key 3", col.clab = "white",
        length = 0.3, width = 0.5, col.axis = "white", 
        col.ticks = "white", at  = c(100, 140, 180), 
        labels = c("a", "b", "c"), font = 2)

 colkey(clim = range(volcano), dist = -0.3, shift = -0.2,
        side = 2, add = TRUE, clab = "key 4", col.clab = "white",
        length = 0.3, width = 0.5, col.axis = "white", 
        col.ticks = "white", col.box = "red", cex.axis = 0.8,
        las = 3)

## =======================================================================
##  colorkey in other plots
## =======================================================================

 par(mfrow = c(1, 1))
 par(mar = par("mar") + c(0, 0, -2, 0))
 image2D(volcano, clab = "height, m", 
       colkey = list(dist = -0.15, shift = 0.2,
       side = 3, length = 0.5, width = 0.5, line.clab = 2.5,
       cex.clab = 2, col.clab = "white", col.axis = "white", 
       col.ticks = "white", cex.axis = 0.8))

## =======================================================================
## Several color keys in composite plot
## =======================================================================

 persp3D(z = volcano, zlim = c(-60, 200), phi = 20, bty = "b",   
    colkey = list(length = 0.2, width = 0.4, shift = 0.15,
      cex.axis = 0.8, cex.clab = 0.85), lighting = TRUE, lphi = 90,
    clab = c("height","m"), plot = FALSE)

# create gradient in x-direction
 Vx &lt;- volcano[-1, ] - volcano[-nrow(volcano), ]

# add as image with own color key, at bottom 
 image3D(z = -60, colvar = Vx/10, add = TRUE, 
    colkey = list(length = 0.2, width = 0.4, shift = -0.15,
      cex.axis = 0.8, cex.clab = 0.85),
   clab = c("gradient","m/m"), plot = TRUE)

## =======================================================================
## categorical colors; use addlines = TRUE to separate colors
## =======================================================================

 with(iris, scatter3D(x = Sepal.Length, y = Sepal.Width, 
   z = Petal.Length, colvar = as.integer(Species), 
   col = c("orange", "green", "lightblue"), pch = 16, cex = 2,  
   clim = c(1, 3), ticktype = "detailed", phi = 20,
   xlab = "Sepal Length", ylab = "Sepal Width", 
   zlab = "Petal Length",  main = "iris",
   colkey = list(at = c(1.33, 2, 2.66), side = 1, 
   addlines = TRUE, length = 0.5, width = 0.5,
   labels = c("setosa", "versicolor", "virginica") )))

# reset plotting parameters
 par(mfrow = pm)
 par(mar = pmar)
</code></pre>

<hr /><div style="text-align: center;">[Package <em>plot3D</em> version 1.4 <a href="00Index.html">Index</a>]</div>
</div>
</body></html>
