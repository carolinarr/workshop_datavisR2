<!DOCTYPE html><html><head><title>R: Plots arrows, segments, points, lines, polygons, rectangles...</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body><div class="container">

<table style="width: 100%;"><tr><td>3-D arrows, segments, polygons, boxes, rectangles {plot3D}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2 id='3-D+20arrows+2C+20segments+2C+20polygons+2C+20boxes+2C+20rectangles'>
Plots arrows, segments, points, lines, polygons, rectangles and boxes in a 3D perspective plot or in 2D.
</h2>

<h3>Description</h3>

<p>Functions <code>arrows3D</code> and <code>segments3D</code> draw arrows and line segments 
between pairs of points.
</p>
<p>Functions <code>box3D</code> and <code>border3D</code> draw boxes between pairs of points. 
</p>
<p><code>polygon3D</code> draws polygons; <code>rect3D</code> draws rectangles.
</p>
<p>The 2D functions <code>arrows2D</code>, <code>segments2D</code>, <code>rect2D</code> and <code>polygon2D</code> are included
for their side effect of having a color key.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>arrows3D (x0, y0, z0, x1 = x0, y1 = y0, z1 = z0, ...,  
         colvar = NULL, phi = 40, theta = 40,
         col = NULL, NAcol = "white", breaks = NULL,
         colkey = NULL, panel.first = NULL,
         clim = NULL, clab = NULL, bty = "b", type = "triangle", 
         add = FALSE, plot = TRUE)

segments3D (x0, y0, z0, x1 = x0, y1 = y0, z1 = z0, ..., 
         colvar = NULL, phi = 40, theta = 40,
         col = NULL, NAcol = "white", breaks = NULL,
         colkey = NULL, panel.first = NULL,
         clim = NULL, clab = NULL, bty = "b", 
         add = FALSE, plot = TRUE)

box3D (x0, y0, z0, x1, y1, z1, ..., 
         colvar = NULL, phi = 40, theta = 40,
         col = NULL, NAcol = "white", breaks = NULL,
         border = NA, facets = TRUE, colkey = NULL,
         panel.first = NULL, clim = NULL, clab = NULL, bty = "b",
         add = FALSE, plot = TRUE)

border3D(x0, y0, z0, x1, y1, z1, ..., 
         colvar = NULL, phi = 40, theta = 40,
         col = NULL, NAcol = "white", breaks = NULL,
         colkey = NULL, panel.first = NULL,
         clim = NULL, clab = NULL, bty = "b", 
         add = FALSE, plot = TRUE)  

rect3D (x0, y0, z0, x1 = NULL, y1 = NULL, z1 = NULL, ..., 
         colvar = NULL, phi = 40, theta = 40,
         col = NULL, NAcol = "white", breaks = NULL,
         border = NA, facets = TRUE, colkey = NULL,
         panel.first = NULL, clim = NULL, clab = NULL, bty = "b",
         add = FALSE, plot = TRUE)

polygon3D (x, y, z, ..., 
         colvar = NULL, phi = 40, theta = 40,
         col = NULL, NAcol = "white", breaks = NULL,
         border = NA, facets = TRUE, colkey = NULL,
         panel.first = NULL, clim = NULL, clab = NULL, bty = "b",
         add = FALSE, plot = TRUE)  
         
arrows2D (x0, y0, x1 = x0, y1 = y0, ..., colvar = NULL,
         col = NULL, NAcol = "white", breaks = NULL,
         colkey = NULL, clim = NULL, clab = NULL, 
         type = "triangle", add = FALSE, plot = TRUE)  

segments2D (x0, y0, x1 = x0, y1 = y0, ..., colvar = NULL,
         col = NULL, NAcol = "white", breaks = NULL,
         colkey = NULL, clim = NULL, clab = NULL, 
         add = FALSE, plot = TRUE) 

rect2D (x0, y0, x1 = x0, y1 = y0, ..., colvar = NULL,
         col = NULL, NAcol = "white", breaks = NULL,
         colkey = NULL, clim = NULL, clab = NULL, 
         add = FALSE, plot = TRUE) 
         
polygon2D (x, y, ..., colvar = NULL, 
         col = NULL, NAcol = "white", breaks = NULL,
         border = NA, facets = TRUE,
         colkey = NULL, clim = NULL, clab = NULL, 
         add = FALSE, plot = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="3-D+20arrows+2C+20segments+2C+20polygons+2C+20boxes+2C+20rectangles_:_x0">x0</code>, <code id="3-D+20arrows+2C+20segments+2C+20polygons+2C+20boxes+2C+20rectangles_:_y0">y0</code>, <code id="3-D+20arrows+2C+20segments+2C+20polygons+2C+20boxes+2C+20rectangles_:_z0">z0</code></td>
<td>
<p>coordinates of points <em>from</em> which to draw.  
</p>
</td></tr>
<tr><td><code id="3-D+20arrows+2C+20segments+2C+20polygons+2C+20boxes+2C+20rectangles_:_x1">x1</code>, <code id="3-D+20arrows+2C+20segments+2C+20polygons+2C+20boxes+2C+20rectangles_:_y1">y1</code>, <code id="3-D+20arrows+2C+20segments+2C+20polygons+2C+20boxes+2C+20rectangles_:_z1">z1</code></td>
<td>
<p>coordinates of points <em>to</em> which to draw. 
For <code>arrows3D</code> and <code>segments3D</code>, at least one must be supplied. 
For <code>rect3D</code> exactly one must be <code>NULL</code>.
</p>
</td></tr>
<tr><td><code id="3-D+20arrows+2C+20segments+2C+20polygons+2C+20boxes+2C+20rectangles_:_x">x</code>, <code id="3-D+20arrows+2C+20segments+2C+20polygons+2C+20boxes+2C+20rectangles_:_y">y</code>, <code id="3-D+20arrows+2C+20segments+2C+20polygons+2C+20boxes+2C+20rectangles_:_z">z</code></td>
<td>
<p>coordinates of the vertices of the polygon. 
The polygon will be closed by joining the last point to the first point. 
The coordinates can contain missing values (<code>NA</code>). 
These <code>NA</code> values break the polygon into several complete polygons.
</p>
</td></tr>
<tr><td><code id="3-D+20arrows+2C+20segments+2C+20polygons+2C+20boxes+2C+20rectangles_:_colvar">colvar</code></td>
<td>
<p>The variable used for coloring. It need
not be present, but if specified, it should be a vector of 
dimension equal to the coordinates or to the number of polygons.
Values of <code>NULL</code>, <code>NA</code>, or <code>FALSE</code>
will toggle off coloration according to <code>colvar</code>. 
</p>
</td></tr>
<tr><td><code id="3-D+20arrows+2C+20segments+2C+20polygons+2C+20boxes+2C+20rectangles_:_theta">theta</code>, <code id="3-D+20arrows+2C+20segments+2C+20polygons+2C+20boxes+2C+20rectangles_:_phi">phi</code></td>
<td>
<p>the angles defining the viewing direction. 
<code>theta</code> gives the azimuthal direction and <code>phi</code> the colatitude. 
See <a href="../../graphics/html/persp.html">persp</a>.
</p>
</td></tr>
<tr><td><code id="3-D+20arrows+2C+20segments+2C+20polygons+2C+20boxes+2C+20rectangles_:_col">col</code></td>
<td>
<p>Color palette to be used for coloring the arrows or segments 
as specified by the <code>colvar</code> variable. 
If <code>col</code> is <code>NULL</code> and <code>colvar</code> is specified, 
then a red-yellow-blue colorscheme (<a href="../../plot3D/help/jet.col.html">jet.col</a>) will be used.
If <code>col</code> is <code>NULL</code> and <code>colvar</code> is not specified, then 
<code>col</code> will be &quot;black&quot;. 
</p>
</td></tr>
<tr><td><code id="3-D+20arrows+2C+20segments+2C+20polygons+2C+20boxes+2C+20rectangles_:_NAcol">NAcol</code></td>
<td>
<p>Colors to be used for <code>colvar</code> values that are <code>NA</code>.
</p>
</td></tr>
<tr><td><code id="3-D+20arrows+2C+20segments+2C+20polygons+2C+20boxes+2C+20rectangles_:_breaks">breaks</code></td>
<td>
<p>a set of finite numeric breakpoints for the colors;
must have one more breakpoint than color and be in increasing order.
Unsorted vectors will be sorted, with a warning.
</p>
</td></tr>
<tr><td><code id="3-D+20arrows+2C+20segments+2C+20polygons+2C+20boxes+2C+20rectangles_:_colkey">colkey</code></td>
<td>
<p>A logical, <code>NULL</code> (default), or a <code>list</code> with parameters
for the color key (legend). List parameters should be one of 
<code>side, plot, length, width, dist, shift, addlines, col.clab, cex.clab,
      side.clab, line.clab, adj.clab, font.clab</code>
and the axis parameters <code>at, labels, tick, line, pos, outer, font, lty, lwd,
    lwd.ticks, col.box, col.axis, col.ticks, hadj, padj, cex.axis, mgp, tck, tcl, las</code>.
The defaults for the parameters are <code>side = 4, plot = TRUE, length = 1, width = 1, 
      dist = 0, shift = 0, addlines = FALSE, col.clab = NULL, cex.clab = par("cex.lab"), 
      side.clab = NULL, line.clab = NULL, adj.clab = NULL, font.clab = NULL</code>)
See <a href="../../plot3D/help/colkey.html">colkey</a>.
</p>
<p>The default is to draw the color key on side = 4, i.e. in the right margin.
If <code>colkey</code> = <code>NULL</code> then a color key will be added only if <code>col</code> is a vector.
Setting <code>colkey = list(plot = FALSE)</code> will create room for the color key 
without drawing it.
if <code>colkey = FALSE</code>, no color key legend will be added.
</p>
</td></tr> 
<tr><td><code id="3-D+20arrows+2C+20segments+2C+20polygons+2C+20boxes+2C+20rectangles_:_border">border</code></td>
<td>
<p>The color of the lines drawn around the surface facets.
The default, <code>NA</code>, will disable the drawing of borders.
</p>
</td></tr>
<tr><td><code id="3-D+20arrows+2C+20segments+2C+20polygons+2C+20boxes+2C+20rectangles_:_facets">facets</code></td>
<td>
<p>If <code>TRUE</code>, then <code>col</code> denotes the color of the surface facets. 
If <code>FALSE</code>, then the surface facets are colored &ldquo;white&rdquo; and the <code>border</code> 
(if <code>NA</code>) will be colored as specified by <code>col</code>. 
If <code>NA</code> then the facets will be transparent. 
It is usually faster to draw with <code>facets = FALSE</code>.
</p>
</td></tr>
<tr><td><code id="3-D+20arrows+2C+20segments+2C+20polygons+2C+20boxes+2C+20rectangles_:_panel.first">panel.first</code></td>
<td>
<p>A <code>function</code> to be evaluated after the plot axes are 
set up but before any plotting takes place. 
This can be useful e.g. for drawing background grids or scatterplot smooths. 
The function should have as argument the transformation matrix, e.g. it should
be defined as <code>function(pmat)</code>. See example of <a href="../../plot3D/help/persp3D.html">persp3D</a> and last example of <a href="../../plot3D/help/voxel3D.html">voxel3D</a>.
</p>
</td></tr> 
<tr><td><code id="3-D+20arrows+2C+20segments+2C+20polygons+2C+20boxes+2C+20rectangles_:_clab">clab</code></td>
<td>
<p>Only if <code>colkey</code> is not <code>NULL</code> or <code>FALSE</code>, 
the label to be written on top of the color key. 
The label will be written at the same level as the main title.
To lower it, <code>clab</code> can be made a vector, with the first values empty 
strings. 
</p>
</td></tr> 
<tr><td><code id="3-D+20arrows+2C+20segments+2C+20polygons+2C+20boxes+2C+20rectangles_:_clim">clim</code></td>
<td>
<p>Only if <code>colvar</code> is specified, the range of the color variable, used
for the color key. Values of <code>colvar</code> that extend the range will be put to <code>NA</code>.
</p>
</td></tr> 
<tr><td><code id="3-D+20arrows+2C+20segments+2C+20polygons+2C+20boxes+2C+20rectangles_:_bty">bty</code></td>
<td>
<p>The type of the perspective box, the default draws only the back panels.
Only effective if the <a href="../../graphics/html/persp.html">persp</a> 
argument (<code>box</code>) equals <code>TRUE</code> (this is the default). See <a href="../../plot3D/help/perspbox.html">perspbox</a>.
</p>
</td></tr>
<tr><td><code id="3-D+20arrows+2C+20segments+2C+20polygons+2C+20boxes+2C+20rectangles_:_type">type</code></td>
<td>
<p>The type of the arrow head, one of <code>"simple"</code> 
(which uses R-function <a href="../../graphics/html/arrows.html">arrows</a>), <code>"curved"</code> or <code>"triangle"</code> and <code>"cone"</code>.
The latter two are the same in <code>plot3D</code> (but differ in package <code>plot3Drgl</code>).
</p>
</td></tr>
<tr><td><code id="3-D+20arrows+2C+20segments+2C+20polygons+2C+20boxes+2C+20rectangles_:_add">add</code></td>
<td>
<p>Logical. If <code>TRUE</code>, then the arrows, segments, ... will be added to the current plot.
If <code>FALSE</code> a new plot is started. 
</p>
</td></tr> 
<tr><td><code id="3-D+20arrows+2C+20segments+2C+20polygons+2C+20boxes+2C+20rectangles_:_plot">plot</code></td>
<td>
<p>Logical. If <code>TRUE</code> (default), a plot is created, 
otherwise the viewing transformation matrix is returned (as invisible). 
</p>
</td></tr> 
<tr><td><code id="3-D+20arrows+2C+20segments+2C+20polygons+2C+20boxes+2C+20rectangles_:_...">...</code></td>
<td>
<p>additional arguments passed to the plotting methods. 
</p>
<p>The following <a href="../../graphics/html/persp.html">persp</a> arguments can be specified: 
<code>xlim, ylim, zlim, xlab, ylab, zlab, main, sub, r, d, 
    scale, expand, box, axes, nticks, ticktype</code>.
The arguments <code>xlim</code>, <code>ylim</code>, <code>zlim</code> only affect the axes for 3D plots.
All objects will be plotted, including those that fall out of these ranges.
To select objects only within the axis limits, use <a href="../../plot3D/help/plotdev.html">plotdev</a>.
</p>
<p><code>shade</code> and <code>lighting</code> arguments will have no effect.
</p>
<p><code>alpha</code> can be given a value inbetween 0 and 1 to make colors transparent.
</p>
<p>In addition, the <a href="../../plot3D/help/perspbox.html">perspbox</a> arguments
<code>col.axis, col.panel, lwd.panel, col.grid, lwd.grid</code> can 
also be given a value.
</p>
<p>For <code>arrows3D</code>, the following <a href="../../graphics/html/arrows.html">arrows</a> arguments can be specified:
<code>length, code, angle</code>.
</p>
<p>For <code>polygon3D</code>, the following <a href="../../graphics/html/polygon.html">polygon</a> arguments can be specified:
<code>border</code>.
</p>
<p>For all the functions, arguments <code>lty, lwd</code> can be specified.
</p>
<p>The arguments after ... must be matched exactly.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns the viewing transformation matrix.
</p>
<p>See <a href="../../plot3D/help/trans3D.html">trans3D</a>.
</p>


<h3>See Also</h3>

<p><a href="../../graphics/html/arrows.html">arrows</a> for the 2-D arrows function on which <code>arrows3D</code> is based.
</p>
<p><a href="../../graphics/html/segments.html">segments</a> for the 2-D arrows function on which <code>segments3D</code> is based.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># save plotting parameters
  pm &lt;- par("mfrow")

## ========================================================================
## arrows, points, segments, box
## ========================================================================

# Create a grid of x, y, and z values
 xx &lt;- yy &lt;- seq(-0.8, 0.8, by = 0.2)
 zz &lt;- seq(-0.8, 0.8, by = 0.8)

 M &lt;- mesh(xx, yy, zz)
 x0 &lt;- M$x; y0 &lt;- M$y; z0 &lt;- M$z
 x1 &lt;- x0 + 0.1

 Col &lt;- c("red", "blue", "green") 
 arrows3D(x0, y0, z0, x1 = x1, colvar = z0, lwd = 2, 
          d = 2, clab = "z-value", col = Col, length = 0.1,
          xlim = c(-0.8, 0.8), ylim = c(-0.8, 0.8),
          main = "arrows3D, points3D, segments3D, border3D")

# add starting point of arrows
 points3D(x0, y0, z0, add = TRUE, colvar = z0, 
           colkey = FALSE, pch = ".", cex = 3, col = Col)

# use segments to add section
 x0 &lt;- c(-0.8, 0.8,  0.8, -0.8)
 x1 &lt;- c( 0.8, 0.8, -0.8, -0.8)
         
 y0 &lt;- c(-0.8, -0.8, 0.8, -0.8)
 y1 &lt;- c(-0.8,  0.8, 0.8, 0.8)

 z0 &lt;- c(0., 0., 0., 0.)
 segments3D(x0, y0, z0, x1, y1, z1 = z0,
     add = TRUE, col = "black", lwd = 2)

# add a box 
 border3D(-0.8, -0.8, -0.8, 0.8, 0.8, 0.8,
       col = "orange", add = TRUE, lwd = 3)

## ========================================================================
## boxes, cubes
## ========================================================================

# borders are boxes without facets  
 border3D(x0 = seq(-0.8, -0.1, by = 0.1), 
       y0 = seq(-0.8, -0.1, by = 0.1),
       z0 = seq(-0.8, -0.1, by = 0.1),
       x1 = seq(0.8, 0.1, by = -0.1),
       y1 = seq(0.8, 0.1, by = -0.1),
       z1 = seq(0.8, 0.1, by = -0.1),
       col = gg.col(8), lty = 2, 
       lwd = c(1, 4), phi = 20, main = "border3D")

 box3D(x0 = -0.8, y0 = -0.8, z0 = -0.8, 
       x1 = 0.8, y1 = 0.8, z1 = 0.8, 
       border = "black", lwd = 2, 
       col = gg.col(1, alpha = 0.8), 
       main = "box3D")

 box3D(x0 = seq(-0.8, -0.1, by = 0.1), 
       y0 = seq(-0.8, -0.1, by = 0.1),
       z0 = seq(-0.8, -0.1, by = 0.1),
       x1 = seq(0.8, 0.1, by = -0.1),
       y1 = seq(0.8, 0.1, by = -0.1),
       z1 = seq(0.8, 0.1, by = -0.1),
       col = rainbow(n = 8, alpha = 0.1), 
       border = "black", lwd = 2, phi = 20)

# here the perspective does not always work 
# use alpha.col to set the transparency of a vector of colors
 box3D(x0 = runif(3), y0 = runif(3), z0 = runif(3),
       x1 = runif(3), y1 = runif(3), z1 = runif(3),
       col = c("red", "lightblue", "orange"), alpha = 0.5,
       border = "black", lwd = 2)

## ========================================================================
## rectangles
## ========================================================================
# at constant 'z'
 rect3D(x0 = seq(-0.8, -0.1, by = 0.1),
        y0 = seq(-0.8, -0.1, by = 0.1),
        z0 = seq(-0.8, -0.1, by = 0.1),
        x1 = seq(0.8, 0.1, by = -0.1),
        y1 = seq(0.8, 0.1, by = -0.1),
        col = gg.col(8), border = "black",
        bty = "g", lwd = 2, phi = 20, main = "rect3D")

# constant y and with transparent facets
 rect3D(x0 = 0, y0 = 0, z0 = 0, x1 = 1, z1 = 5,
        ylim = c(0, 1), facets = NA, border = "red",
        bty = "g", lwd = 2, phi = 20)

# add rect at constant z, with colored facet
 rect3D(x0 = 0, y0 = 0, z0 = 0, x1 = 1, y1 = 1,
        border = "red", add = TRUE)

## ========================================================================
## arrows added to a persp plot 
## ========================================================================

 x &lt;- y &lt;- seq(-10, 10, length = 30)
 z &lt;- outer(x, y, FUN = function(x,y) x^2 + y^2)

 persp3D(x, y, z, theta = 30, phi = 30, 
         col = "lightblue", ltheta = 120, shade = 0.75, 
         ticktype = "detailed", xlab = "X", 
         ylab = "Y", zlab = "x^2+y^2" )  

# Points where to put the arrows
 x &lt;- y &lt;- seq(-10, 10, len = 6)
 X0 &lt;- outer(x, y, FUN = function (x,y) x)
 Y0 &lt;- outer(x, y, FUN = function (x,y) y)
 Z0 &lt;- outer(x, y, FUN = function (x,y) x^2 + y^2)

 X1 &lt;- X0 + 1
 Y1 &lt;- Y0 + 1
 Z1 &lt;- Z0 + 10

 arrows3D(X0, Y0, Z0, X1, Y1, Z1, lwd = 2, 
         add = TRUE, type = "curved", col = "red")

 segments3D(X0, Y0, Z0, X0, Y0, rep(0, length(X0)), lwd = 2, 
         add = TRUE, col = "green")

## ========================================================================
## polygon3D 
## ========================================================================

 x &lt;- runif(10)
 y &lt;- runif(10)
 z &lt;- runif(10)
 
 polygon3D(x, y, z)

# several polygons, separated by NAs
 x &lt;- runif(39) 
 y &lt;- runif(39)
 z &lt;- runif(39)
 ii &lt;- seq(4, 36, by  = 4)
 x[ii] &lt;- y[ii] &lt;- z[ii] &lt;- NA 

# transparent colors (alpha)
 polygon3D(x, y, z, border = "black", lwd = 3,
   col = gg.col(length(ii) + 1, alpha = 0.8), 
   main = "polygon3D")

## ========================================================================
## 2D examples, with color key
## ========================================================================

arrows2D(x0 = runif(10), y0 = runif(10),
         x1 = runif(10), y1 = runif(10), colvar = 1:10, 
         code = 3, main = "arrows2D, segments2D")

segments2D(x0 = runif(10), y0 = runif(10),
         x1 = runif(10), y1 = runif(10), colvar = 1:10, 
         lwd = 2, add = TRUE, colkey = FALSE) 

# transparency
rect2D(x0 = runif(10), y0 = runif(10),
       x1 = runif(10), y1 = runif(10), colvar = 1:10, 
       alpha = 0.4, lwd = 2, main = "rect2D") 

## ========================================================================
## polygon2D 
## ========================================================================

 x &lt;- runif(10)
 y &lt;- runif(10)
 
 polygon2D(x, y)    # same as polygon

# several polygons, separated by NAs
 x &lt;- runif(59) 
 y &lt;- runif(59)

 ii &lt;- seq(5, 55, by  = 5)
 x[ii] &lt;- y[ii] &lt;- NA 

# transparent colors (alpha)
 polygon2D(x, y, border = "black", lwd = 3,
   colvar = 1:(length(ii) + 1), 
   col = gg.col(), alpha = 0.2,
   main = "polygon2D")

# restore plotting parameters
 par(mfrow = pm)

</code></pre>

<hr /><div style="text-align: center;">[Package <em>plot3D</em> version 1.4 <a href="00Index.html">Index</a>]</div>
</div>
</body></html>
