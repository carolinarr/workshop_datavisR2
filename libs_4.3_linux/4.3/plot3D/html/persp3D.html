<!DOCTYPE html><html><head><title>R: Perspective plots, 3-D ribbons and 3-D histograms.</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body><div class="container">

<table style="width: 100%;"><tr><td>3-D perspectives {plot3D}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2 id='3-D+20perspectives'>
Perspective plots, 3-D ribbons and 3-D histograms.
</h2>

<h3>Description</h3>

<p><code>persp3D</code> extends R's <a href="../../graphics/html/persp.html">persp</a> function. 
</p>
<p><code>ribbon3D</code> is similar to <code>persp3D</code> but has ribbon-like colored surfaces.
</p>
<p><code>hist3D</code> generates 3-D histograms.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>persp3D (x = seq(0, 1, length.out = nrow(z)), 
       y = seq(0, 1, length.out = ncol(z)), z, ..., 
       colvar = z, phi = 40, theta = 40,
       col = NULL,  NAcol = "white", breaks = NULL,
       border = NA, facets = TRUE, colkey = NULL, resfac = 1,
       image = FALSE, contour = FALSE, panel.first = NULL,
       clim = NULL, clab = NULL, bty = "b", 
       lighting = FALSE, shade = NA, ltheta = -135, lphi = 0,
       inttype = 1, curtain = FALSE, add = FALSE, plot = TRUE)

ribbon3D (x = seq(0, 1, length.out = nrow(z)), 
      y = seq(0, 1, length.out = ncol(z)), z, ..., 
      colvar = z, phi = 40, theta = 40, 
      col = NULL,  NAcol = "white", breaks = NULL,
      border = NA, facets = TRUE, colkey = NULL, resfac = 1,
      image = FALSE, contour = FALSE, panel.first = NULL,
      clim = NULL, clab = NULL, bty = "b",
      lighting = FALSE, shade = NA, ltheta = -135, lphi = 0,
      space = 0.4, along = "x", 
      curtain = FALSE, add = FALSE, plot = TRUE)

hist3D (x = seq(0, 1, length.out = nrow(z)),
      y = seq(0, 1, length.out = ncol(z)), z, ..., 
      colvar = z, phi = 40, theta = 40, 
      col = NULL, NAcol = "white", breaks = NULL,
      border = NA, facets = TRUE, colkey = NULL,
      image = FALSE, contour = FALSE,
      panel.first = NULL, clim = NULL, clab = NULL, bty = "b", 
      lighting = FALSE, shade = NA, ltheta = -135, lphi = 0,
      space = 0, opaque.top = FALSE, zmin = NULL,
      add = FALSE, plot = TRUE)  
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="3-D+20perspectives_:_z">z</code></td>
<td>
<p>Matrix (2-D) containing the values to be plotted as a <a href="../../graphics/html/persp.html">persp</a> plot. 
</p>
</td></tr>
<tr><td><code id="3-D+20perspectives_:_x">x</code>, <code id="3-D+20perspectives_:_y">y</code></td>
<td>
<p>Vectors or matrices with x and y values. 
If a vector, <code>x</code> should be of length equal to <code>nrow(z)</code> and 
<code>y</code> should be equal to <code>ncol(z)</code>. If a matrix (only for <code>persp3D</code>), 
<code>x</code> and <code>y</code> should have the same dimension as <code>z</code>.
</p>
</td></tr>
<tr><td><code id="3-D+20perspectives_:_colvar">colvar</code></td>
<td>
<p>The variable used for coloring. If present, it should have the 
same dimension as <code>z</code>. Values of <code>NULL</code>, <code>NA</code>, or <code>FALSE</code>
will toggle off coloration according to <code>colvar</code>. This gives good results
only if <code>border</code> is given a color, or when <code>shade</code> is &gt; 0 or 
<code>lighting</code> is <code>TRUE</code>).
</p>
</td></tr>
<tr><td><code id="3-D+20perspectives_:_col">col</code></td>
<td>
<p>Color palette to be used for the <code>colvar</code> variable.
If <code>col</code> is <code>NULL</code> and <code>colvar</code> is specified, 
then a red-yellow-blue colorscheme (<a href="../../plot3D/help/jet.col.html">jet.col</a>) will be used.
If <code>col</code> is <code>NULL</code> and <code>colvar</code> is not specified, then 
<code>col</code> will be <code>grey</code>. 
</p>
<p>Finally, to mimic the behavior of <a href="../../graphics/html/persp.html">persp</a>, set <code>colvar</code> = <code>NULL</code>
and make <code>col</code> a matrix of colors with (nrow(z)-1) rows and 
(ncol(z)-1) columns.
</p>
</td></tr>
<tr><td><code id="3-D+20perspectives_:_NAcol">NAcol</code></td>
<td>
<p>Color to be used for <code>NA</code> values of <code>colvar</code>; default is &ldquo;white&rdquo;. 
</p>
</td></tr>
<tr><td><code id="3-D+20perspectives_:_breaks">breaks</code></td>
<td>
<p>a set of finite numeric breakpoints for the colors;
must have one more breakpoint than color and be in increasing order.
Unsorted vectors will be sorted, with a warning.
</p>
</td></tr>
<tr><td><code id="3-D+20perspectives_:_colkey">colkey</code></td>
<td>
<p>A logical, <code>NULL</code> (default), or a <code>list</code> with parameters
for the color key (legend). List parameters should be one of 
<code>side, plot, length, width, dist, shift, addlines, col.clab, cex.clab,
      side.clab, line.clab, adj.clab, font.clab</code>
and the axis parameters <code>at, labels, tick, line, pos, outer, font, lty, lwd,
    lwd.ticks, col.box, col.axis, col.ticks, hadj, padj, cex.axis, mgp, tck, tcl, las</code>.
The defaults for the parameters are <code>side = 4, plot = TRUE, length = 1, width = 1, 
      dist = 0, shift = 0, addlines = FALSE, col.clab = NULL, cex.clab = par("cex.lab"), 
      side.clab = NULL, line.clab = NULL, adj.clab = NULL, font.clab = NULL</code>)
See <a href="../../plot3D/help/colkey.html">colkey</a>.
</p>
<p>The default is to draw the color key on side = 4, i.e. in the right margin.
If <code>colkey</code> = <code>NULL</code> then a color key will be added only if <code>col</code> is a vector.
Setting <code>colkey = list(plot = FALSE)</code> will create room for the color key 
without drawing it.
if <code>colkey = FALSE</code>, no color key legend will be added.
</p>
</td></tr> 
<tr><td><code id="3-D+20perspectives_:_clab">clab</code></td>
<td>
<p>Only if <code>colkey = TRUE</code>, the label to be written on top of the
color key. The label will be written at the same level as the main title.
to lower it, <code>clab</code> can be made a vector, with the first values empty 
strings. 
</p>
</td></tr> 
<tr><td><code id="3-D+20perspectives_:_clim">clim</code></td>
<td>
<p>Only if <code>colvar</code> is specified, the range of the color variable, used
for the color key. Values of <code>colvar</code> that extend the range will be put to <code>NA</code>.
</p>
</td></tr> 
<tr><td><code id="3-D+20perspectives_:_resfac">resfac</code></td>
<td>
<p>Resolution factor, one value or a vector of two numbers, for 
the x and y- values respectively. A value &gt; 1 will increase the 
resolution. For instance, if <code>resfac</code> equals <code>3</code> then for each 
adjacent pair of x- and y-values, z will be interpolated to two intermediary points. 
This uses simple linear interpolation. If <code>resfac</code> is one number then
the resolution will be increased similarly in x and y-direction.  
</p>
</td></tr>
<tr><td><code id="3-D+20perspectives_:_theta">theta</code>, <code id="3-D+20perspectives_:_phi">phi</code></td>
<td>
<p>The angles defining the viewing direction. 
<code>theta</code> gives the azimuthal direction and <code>phi</code> the colatitude. 
see <a href="../../graphics/html/persp.html">persp</a>.
</p>
</td></tr>
<tr><td><code id="3-D+20perspectives_:_border">border</code></td>
<td>
<p>The color of the lines drawn around the surface facets.
The default, <code>NA</code>, will disable the drawing of borders.
</p>
</td></tr>
<tr><td><code id="3-D+20perspectives_:_facets">facets</code></td>
<td>
<p>If <code>TRUE</code>, then <code>col</code> denotes the color of the surface facets. 
If <code>FALSE</code>, then the surface facets are colored &ldquo;white&rdquo; and the <code>border</code> 
(if <code>NA</code>) will be colored as specified by <code>col</code>. 
If <code>NA</code> then the facets will be transparent. 
It is usually faster to draw with <code>facets = FALSE</code>.
</p>
</td></tr>
<tr><td><code id="3-D+20perspectives_:_image">image</code></td>
<td>
<p>If <code>TRUE</code>, an image will be plotted at the bottom. 
Also allowed is to pass a <code>list</code> with arguments for the <a href="../../plot3D/help/image2D.html">image2D</a> function.
An optional parameter to this <code>list</code> is the <code>side</code> where the image 
should be plotted. Allowed values for <code>side</code> are a z-value, 
or <code>side = "zmin", "zmax"</code>, for positioning at 
bottom or top respectively.  The default is to put the image at the bottom.
</p>
</td></tr>
<tr><td><code id="3-D+20perspectives_:_contour">contour</code></td>
<td>
<p>If <code>TRUE</code>, a <a href="../../graphics/html/contour.html">contour</a> will be plotted at the bottom. 
Also allowed is to pass a <code>list</code> with arguments for the <a href="../../graphics/html/contour.html">contour</a> function.
An optional parameter to this <code>list</code> is the <code>side</code> where the image 
should be plotted. Allowed values for <code>side</code> are a z-value, 
or <code>side = "zmin", "zmax"</code>, for positioning at 
bottom or top respectively.  The default is to put the image at the bottom.
</p>
</td></tr>
<tr><td><code id="3-D+20perspectives_:_panel.first">panel.first</code></td>
<td>
<p>A <code>function</code> to be evaluated after the plot axes are 
set up (and if applicable, images or contours drawn) but before any plotting takes place. 
This can be useful for drawing background grids or scatterplot smooths. 
The function should have as argument the transformation matrix (pmat), e.g. it should
be defined as <code>function(pmat)</code>. See example.
</p>
</td></tr> 
<tr><td><code id="3-D+20perspectives_:_along">along</code></td>
<td>
<p>The direction along which the ribbons are drawn, one of &quot;x&quot;, &quot;y&quot; or &quot;xy&quot;,
for ribbons parallel to the x- y- or both axes. In the latter case, the 
figure looks like a net.
</p>
</td></tr>
<tr><td><code id="3-D+20perspectives_:_curtain">curtain</code></td>
<td>
<p>If <code>TRUE</code>, the ribbon or persp edges will be draped till the bottom. 
</p>
</td></tr>
<tr><td><code id="3-D+20perspectives_:_space">space</code></td>
<td>
<p>The amount of space (as a fraction of the average bar/ribbon width) 
left between bars/ribbons. A value inbetween [0, 0.9] (<code>hist3D</code>) 
or [0.1, 0.9] (<code>ribbon3D</code>). Either one number, or a two-valued vector, 
for the x- and y- direction.
</p>
</td></tr>
<tr><td><code id="3-D+20perspectives_:_bty">bty</code></td>
<td>
<p>The type of the box, the default only drawing background panels.
Only effective if the <a href="../../graphics/html/persp.html">persp</a> 
argument (<code>box</code>) equals <code>TRUE</code> (this is the default). See <a href="../../plot3D/help/perspbox.html">perspbox</a>.
</p>
</td></tr>
<tr><td><code id="3-D+20perspectives_:_lighting">lighting</code></td>
<td>
<p>If not <code>FALSE</code> the facets will be illuminated, and colors may
appear more bright. To switch on lighting, the argument <code>lighting</code> 
should be either set to <code>TRUE</code> (using default settings) or it can be a 
list with specifications of one of the following: 
<code>ambient, diffuse, specular, exponent, sr</code> and <code>alpha</code>. 
</p>
<p>Will overrule <code>shade</code> not equal to <code>NA</code>.
</p>
<p>See examples in <a href="../../plot3D/help/jet.col.html">jet.col</a>.
</p>
</td></tr>  
<tr><td><code id="3-D+20perspectives_:_shade">shade</code></td>
<td>
<p>the degree of shading of the surface facets. 
Values of shade close to one yield shading similar to a point light 
source model and values close to zero produce no shading. 
Values in the range 0.5 to 0.75 provide an approximation to daylight illumination.
See <a href="../../graphics/html/persp.html">persp</a>.
</p>
</td></tr> 
<tr><td><code id="3-D+20perspectives_:_ltheta">ltheta</code>, <code id="3-D+20perspectives_:_lphi">lphi</code></td>
<td>
<p>if finite values are specified for <code>ltheta</code> and 
<code>lphi</code>, the surface is shaded as though it was being illuminated from 
the direction specified by azimuth <code>ltheta</code> and colatitude <code>lphi</code>.
See <a href="../../graphics/html/persp.html">persp</a>.
</p>
</td></tr>
<tr><td><code id="3-D+20perspectives_:_inttype">inttype</code></td>
<td>
<p>The interpolation type to create the polygons, either 
averaging the <code>colvar</code> (<code>inttype = 1, 3</code> or extending 
the <code>x, y, z</code> values (<code>inttype = 2</code>) - see details.
</p>
</td></tr> 
<tr><td><code id="3-D+20perspectives_:_opaque.top">opaque.top</code></td>
<td>
<p>Only used when <code>alpha</code> is set (transparency):
if <code>TRUE</code> then the top of the bars is opaque.
</p>
</td></tr> 
<tr><td><code id="3-D+20perspectives_:_zmin">zmin</code></td>
<td>
<p>The base of the histogram ; if <code>NULL</code> then it extends to 
the minimum of the z-axis. Note: this was added from version 1.1.1 on;
before that it was assumed that the base of the histogram was at z=0. 
</p>
</td></tr> 
<tr><td><code id="3-D+20perspectives_:_add">add</code></td>
<td>
<p>Logical. If <code>TRUE</code>, then the surfaces will be added to the current plot.
If <code>FALSE</code> a new plot is started. 
</p>
</td></tr> 
<tr><td><code id="3-D+20perspectives_:_plot">plot</code></td>
<td>
<p>Logical. If <code>TRUE</code> (default), a plot is created, 
otherwise the viewing transformation matrix is returned (as invisible). 
</p>
</td></tr> 
<tr><td><code id="3-D+20perspectives_:_...">...</code></td>
<td>
<p>additional arguments passed to the plotting methods. 
The following <a href="../../graphics/html/persp.html">persp</a> arguments can be specified: 
<code>xlim, ylim, zlim, xlab, ylab, zlab, main, sub, r, d, 
    scale, expand, box, axes, nticks, ticktype</code>. 
The arguments <code>xlim</code>, <code>ylim</code>, <code>zlim</code> only affect the axes.
All objects will be plotted, including those that fall out of these ranges.
To select objects only within the axis limits, use <a href="../../plot3D/help/plotdev.html">plotdev</a>.
</p>
<p>In addition, the <a href="../../plot3D/help/perspbox.html">perspbox</a> arguments
<code>col.axis, col.panel, lwd.panel, col.grid, lwd.grid</code> can 
also be given a value.
</p>
<p><code>alpha</code> can be given a value inbetween 0 and 1 to make colors transparent.
</p>
<p>For all functions, the arguments <code>lty, lwd</code> can be specified; this is only
effective is <code>border</code> is not <code>NA</code>.
</p>
<p>The arguments after ... must be matched exactly.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>persp3D</code> is an extension to the default <a href="../../graphics/html/persp.html">persp</a> plot that has
the possibility to add a color key, to increase the 
resolution in order to make smoother images, 
to toggle on or off facet coloration, ... 
</p>
<p>The perspective plots are drawn as filled polygons. Each polygon is defined by 
4 corners and a color, defined in its centre. 
When facets are colored, there are three interpolation schemes as set by <code>inttype</code>. 
</p>
<p>The default (<code>inttype = 1</code>) is similar to R's function <code>persp</code>, 
and assumes that the <code>z</code>-values define the points on the corners of 
each polygon. In case a <code>colvar</code> is defined, its values are to be recalculated 
to the middle of each polygon, i.e. the color values need to be of size 
(nx-1)(ny-1), and averages are taken from the original data 
(nx and ny are number of x and y points). 
This will make the colors (and/or shading) smoother.
When <code>inttype = 1</code> then <code>NA</code> values in <code>colvar</code> will be used as 
such during the averaging. This will tend to make the <code>NA</code> region larger.
</p>
<p>An alternative is to set <code>inttype = 3</code>, which is similar to <code>inttype = 1</code>
except for the <code>NA</code> values, which will be removed during the averaging.
This will tend to make the <code>NA</code> region smaller.
</p>
<p>By setting <code>inttype = 2</code>, a second interpolation scheme 
is selected. This is mainly of use in case a <code>colvar</code> is defined, and it 
is not desirable that the colors are smoothened. 
In this scheme, it is assumed that the <code>z</code> values and <code>colvar</code> 
values are both defined in the centre of the polygons.
To color the facets the x, y, z grid is extended (to a (nx+1)(ny+1) grid), 
while <code>colvar</code> is used as such. 
This will make the z-values (topography) smoother than the original data.
This type of interpolation may be preferable for color variables that have <code>NA</code> values,
as taking averages tends to increase the <code>NA</code> region.
</p>


<h3>Value</h3>

<p>Returns, as invisible, the viewing transformation matrix.
</p>
<p>See <a href="../../plot3D/help/trans3D.html">trans3D</a>.
</p>


<h3>Note</h3>

<p>To make a <code>contour</code> to appear on top of an image, 
i.e. when <code>side = "z"</code>, the viewing depth
of the contour segments is artificially decreased. In some cases this 
may produce slight artifacts. The viewing depth can be adjusted with argument <code>dDepth</code>,
e.g. <code>persp3D(z = volcano, contour = list(side = "z", dDepth = 0.))</code>
</p>
<p>Parts of this help page come from the help pages of the R-core function 
<a href="../../graphics/html/persp.html">persp</a>.
</p>


<h3>Author(s)</h3>

<p>Karline Soetaert &lt;karline.soetaert@nioz.nl&gt;
</p>


<h3>References</h3>

<p>The <a href="../../graphics/html/persp.html">persp</a> function on which this implementation is based:
</p>
<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988) 
The New S Language. Wadsworth &amp; Brooks/Cole. 
</p>


<h3>See Also</h3>

<p><a href="../../graphics/html/persp.html">persp</a> for the function on which this is based.
</p>
<p><a href="../../plot3D/help/Hypsometry.html">Hypsometry</a> for an example where axis-panels are colored.
</p>
<p><a href="../../plot3D/help/scatter3D.html">scatter3D</a> for a combination of a persp surface and data points.  
</p>
<p><a href="../../plot3D/help/text3D.html">text3D</a> for annotating axes (hist3D).
</p>
<p><a href="../../plot3D/help/plotdev.html">plotdev</a> for zooming, rescaling, rotating a plot.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># save plotting parameters
 pm &lt;- par("mfrow")

## =======================================================================
## Ribbon, persp, color keys, facets
## =======================================================================

 par(mfrow = c(2, 2))
# simple, no scaling, use breaks to set colors
 persp3D(z = volcano, main = "volcano", clab = c("height", "m"), 
   breaks = seq(80,200, by = 10))
  
# keep ratios between x- and y (scale = FALSE) 
# change ratio between x- and z (expand)
 persp3D(z = volcano, x = 1: nrow(volcano), y = 1:ncol(volcano),
       expand = 0.3, main = "volcano", facets = FALSE, scale = FALSE,
       clab = "height, m", colkey = list(side = 1, length = 0.5))

# ribbon, in x--direction
 V &lt;- volcano[, seq(1, ncol(volcano), by = 3)]  # lower resolution
 ribbon3D(z = V, colkey = list(width = 0.5, length = 0.5, 
          cex.axis = 0.8, side = 2), clab = "m")

# ribbon, in y-direction
 Vy &lt;- volcano[seq(1, nrow(volcano), by = 3), ]
 ribbon3D(z = Vy, expand = 0.3, space = 0.3, along = "y", 
          colkey = list(width = 0.5, length = 0.5, cex.axis = 0.8))
  
## =======================================================================
## Several ways to visualise 3-D data
## =======================================================================

 x &lt;- seq(-pi, pi, by = 0.2)
 y &lt;- seq(-pi, pi, by = 0.3)
 grid &lt;- mesh(x, y)

 z    &lt;- with(grid, cos(x) * sin(y))

 par(mfrow = c(2,2))

 persp3D(z = z, x = x, y = y)

 persp3D(z = z, x = x, y = y, facets = FALSE, curtain = TRUE)

# ribbons in two directions and larger spaces
 ribbon3D(z = z, x = x, y = y, along = "xy", space = 0.3)

 hist3D(z = z, x = x, y = y, border = "black")  
  
## =======================================================================
## Contours and images added
## =======================================================================

 par(mfrow = c(2, 2))
 x &lt;- seq(1, nrow(volcano), by = 3)
 y &lt;- seq(1, ncol(volcano), by = 3) 

 Volcano &lt;- volcano [x, y]
 ribbon3D(z = Volcano, contour = TRUE, zlim= c(-100, 200), 
          image = TRUE)

 persp3D(z = Volcano, contour = TRUE, zlim= c(-200, 200), image = FALSE)

 persp3D(z = Volcano, x = x, y = y, scale = FALSE, 
       contour = list(nlevels = 20, col = "red"), 
       zlim = c(-200, 200), expand = 0.2,
       image = list(col = grey (seq(0, 1, length.out = 100))))

 persp3D(z = Volcano, contour = list(side = c("zmin", "z", "350")), 
       zlim = c(-100, 400), phi = 20, image = list(side = 350))

## =======================================================================
## Use of inttype
## =======================================================================

 par(mfrow = c(2, 2))
 persp3D(z = Volcano, shade = 0.5, colkey = FALSE)
 persp3D(z = Volcano, inttype = 2, shade = 0.5, colkey = FALSE)

 x &lt;- y &lt;- seq(0, 2*pi, length.out = 10)
 z &lt;- with (mesh(x, y), cos(x) *sin(y)) + runif(100)
 cv &lt;- matrix(nrow = 10, ncol = 10, 0.5*runif(100))
 persp3D(x, y, z, colvar = cv)              # takes averages of z
 persp3D(x, y, z, colvar = cv, inttype = 2) # takes averages of colvar

## =======================================================================
## Use of inttype with NAs
## =======================================================================

 par(mfrow = c(2, 2))
 VV &lt;- V2 &lt;- volcano[10:15, 10:15]
 V2[3:4, 3:4] &lt;- NA
 V2[4, 5] &lt;- NA

 image2D(V2, border = "black")  # shows true NA region

# averages of V2, including NAs, NA region larger
 persp3D(z = VV, colvar = V2, inttype = 1, theta = 0, 
       phi = 20, border = "black", main = "inttype = 1")

# extension of VV; NAs unaffected
 persp3D(z = VV, colvar = V2, inttype = 2, theta = 0, 
       phi = 20, border = "black", main = "inttype = 2")

# average of V2, ignoring NA; NA region smaller
 persp3D(z = VV, colvar = V2, inttype = 3, theta = 0, 
       phi = 20, border = "black", main = "inttype = 3")

## =======================================================================
## Use of panel.first
## =======================================================================

 par(mfrow = c(1, 1))

# A function that is called after the axes were drawn
 panelfirst &lt;- function(trans) {
    zticks &lt;- seq(100, 180, by = 20)
    len &lt;- length(zticks)
    XY0 &lt;- trans3D(x = rep(1, len), y = rep(1, len), z = zticks,
                   pmat = trans)
    XY1 &lt;- trans3D(x = rep(1, len), y = rep(61, len), z = zticks,
                   pmat = trans)
    segments(XY0$x, XY0$y, XY1$x, XY1$y, lty = 2) 
    
    rm &lt;- rowMeans(volcano)             
    XY &lt;- trans3D(x = 1:87, y = rep(ncol(volcano), 87), 
                  z = rm, pmat = trans)
    lines(XY, col = "blue", lwd = 2)
 }
 persp3D(z = volcano, x = 1:87, y = 1: 61, scale = FALSE, theta = 10,
       expand = 0.2, panel.first = panelfirst, colkey = FALSE)
                                                       
## =======================================================================
## with / without colvar / facets 
## =======================================================================

 par(mfrow = c(2, 2))
 persp3D(z = volcano, shade = 0.3, col = gg.col(100))

# shiny colors - set lphi for more brightness
 persp3D(z = volcano, lighting = TRUE, lphi = 90)

 persp3D(z = volcano, col = "lightblue", colvar = NULL, 
   shade = 0.3, bty = "b2")

# this also works:
#  persp3D(z = volcano, col = "grey", shade = 0.3)

# tilted x- and y-coordinates of 'volcano'
 volcx &lt;- matrix(nrow = 87, ncol = 61, data = rep(1:87, times=61))
 volcx &lt;- volcx + matrix(nrow = 87, ncol = 61, byrow = TRUE, 
        data = rep(seq(0., 15, length.out=61), times=87))

 volcy &lt;- matrix(ncol = 87, nrow = 61, data = rep(1:61, times=87))
 volcy &lt;- t(volcy + matrix(ncol = 87, nrow = 61, byrow = TRUE, 
        data = rep(seq(0., 15, length.out=87), times=61)))

 persp3D(volcano, x = volcx, y = volcy, phi = 80)
    
## =======================================================================
## Several persps on one plot
## =======================================================================

 par(mfrow = c(1, 1))
 clim &lt;- range(volcano)
 persp3D(z = volcano, zlim = c(100, 600), clim = clim, 
   box = FALSE, plot = FALSE)
  
 persp3D(z = volcano + 200, clim = clim, colvar = volcano, 
       add = TRUE, colkey = FALSE, plot = FALSE)

 persp3D(z = volcano + 400, clim = clim, colvar = volcano, 
       add = TRUE, colkey = FALSE)    # plot = TRUE by default

## =======================================================================
## hist3D
## =======================================================================

 par(mfrow = c(2, 2))
 VV   &lt;- volcano[seq(1, 87, 15), seq(1, 61, 15)]
 hist3D(z = VV, scale = FALSE, expand = 0.01, border = "black")

# transparent colors
 hist3D(z = VV, scale = FALSE, expand = 0.01, 
   alpha = 0.5, opaque.top = TRUE, border = "black")

 hist3D(z = VV, scale = FALSE, expand = 0.01, facets = FALSE, lwd = 2)

 hist3D(z = VV, scale = FALSE, expand = 0.01, facets = NA)

## =======================================================================
## hist3D and ribbon3D with greyish background, rotated, rescaled,...
## =======================================================================

 par(mfrow = c(2, 2))
 hist3D(z = VV, scale = FALSE, expand = 0.01, bty = "g", phi = 20,
        col = "#0072B2", border = "black", shade = 0.2, ltheta = 90,
        space = 0.3, ticktype = "detailed", d = 2)

# extending the ranges
 plotdev(xlim = c(-0.2, 1.2), ylim = c(-0.2, 1.2), theta = 45)

 ribbon3D(z = VV, scale = FALSE, expand = 0.01, bty = "g", phi = 20,
        col = "lightblue", border = "black", shade = 0.2, ltheta = 90,
        space = 0.3, ticktype = "detailed", d = 2, curtain = TRUE)

 ribbon3D(z = VV, scale = FALSE, expand = 0.01, bty = "g", phi = 20, zlim = c(95,183),
        col = "lightblue", lighting = TRUE, ltheta = 50, along = "y",
        space = 0.7, ticktype = "detailed", d = 2, curtain = TRUE)

## =======================================================================
## hist3D for a 1-D data set
## =======================================================================

 par(mfrow = c(2, 1))
 x &lt;- rchisq(1000, df = 4)
 hs &lt;- hist(x, breaks = 15)
 
 hist3D(x = hs$mids, y = 1, z = matrix(ncol = 1, data = hs$density), 
  bty = "g", ylim = c(0., 2.0), scale = FALSE, expand = 20, 
  border = "black", col = "white", shade = 0.3, space = 0.1, 
  theta = 20, phi = 20, main = "3-D perspective")

          
# reset plotting parameters
 par(mfrow = pm)
</code></pre>

<hr /><div style="text-align: center;">[Package <em>plot3D</em> version 1.4 <a href="00Index.html">Index</a>]</div>
</div>
</body></html>
