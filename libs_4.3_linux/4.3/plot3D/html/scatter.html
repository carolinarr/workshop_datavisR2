<!DOCTYPE html><html><head><title>R: Colored scatter plots and text in 2-D and 3-D</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body><div class="container">

<table style="width: 100%;"><tr><td>Scatter plots {plot3D}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2 id='Scatter+20plots'>
Colored scatter plots and text in 2-D and 3-D
</h2>

<h3>Description</h3>

<p><code>scatter2D and scatter3D</code> plot a (2- or 3 dimensional) dataset with a color variable as points or lines.
</p>
<p><code>text3D</code> plot a 3-D dataset with a color variable as text labels.
</p>
<p><code>points3D</code> is shorthand for <code><a href="../../plot3D/help/scatter3D.html">scatter3D</a>(..., type = "p")</code>
</p>
<p><code>lines3D</code> is shorthand for <code><a href="../../plot3D/help/scatter3D.html">scatter3D</a>(..., type = "l")</code>
</p>
<p><code>points2D</code> is shorthand for <code>scatter2D(..., type = "p")</code>
</p>
<p><code>lines2D</code> is shorthand for <code>scatter2D(..., type = "l")</code>
</p>
<p>The 2D functions are included for their side effect of having a color key.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>scatter3D (x, y, z, ..., colvar = z, phi = 40, theta = 40,
           col = NULL, NAcol = "white", breaks = NULL,
           colkey = NULL, panel.first = NULL, 
           clim = NULL, clab = NULL, 
           bty = "b", CI = NULL, surf = NULL, 
           add = FALSE, plot = TRUE)
          
text3D (x, y, z, labels, ..., colvar = NULL, phi = 40, theta = 40,
        col = NULL, NAcol = "white",  breaks = NULL,
        colkey = NULL, panel.first = NULL, 
        clim = NULL, clab = NULL, 
        bty = "b", add = FALSE, plot = TRUE)

points3D (x, y, z, ...)

lines3D (x, y, z, ...)

scatter2D (x, y, ..., colvar = NULL,
         col = NULL, NAcol = "white", breaks = NULL,
         colkey = NULL, clim = NULL, clab = NULL, 
         CI = NULL, add = FALSE, plot = TRUE)

lines2D(x, y, ...)

points2D(x, y, ...)

text2D (x, y, labels, ..., colvar = NULL, 
         col = NULL, NAcol = "white", breaks = NULL, colkey = NULL,
         clim = NULL, clab = NULL, add = FALSE, plot = TRUE) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Scatter+20plots_:_x">x</code>, <code id="Scatter+20plots_:_y">y</code>, <code id="Scatter+20plots_:_z">z</code></td>
<td>
<p>Vectors with x, y and z-values of the points to be plotted. 
They should be of equal length, and the same length as <code>colvar</code> (if present).
</p>
</td></tr>
<tr><td><code id="Scatter+20plots_:_colvar">colvar</code></td>
<td>
<p>The variable used for coloring. For <code>scatter3D</code>, it need
not be present, but if specified, it should be a vector of equal length as 
(<code>x, y, z</code>).
</p>
</td></tr>
<tr><td><code id="Scatter+20plots_:_theta">theta</code>, <code id="Scatter+20plots_:_phi">phi</code></td>
<td>
<p>the angles defining the viewing direction. 
<code>theta</code> gives the azimuthal direction and <code>phi</code> the colatitude. see <a href="../../graphics/html/persp.html">persp</a>.
</p>
</td></tr>
<tr><td><code id="Scatter+20plots_:_col">col</code></td>
<td>
<p>Color palette to be used for coloring the <code>colvar</code> variable. 
If <code>col</code> is <code>NULL</code> and <code>colvar</code> is specified, 
then a red-yellow-blue colorscheme (<a href="../../plot3D/help/jet.col.html">jet.col</a>) will be used.
If <code>col</code> is <code>NULL</code> and <code>colvar</code> is not specified, then 
<code>col</code> will be &quot;black&quot;.    
</p>
</td></tr>
<tr><td><code id="Scatter+20plots_:_NAcol">NAcol</code></td>
<td>
<p>Colors to be used for <code>colvar</code> values that are <code>NA</code>.
</p>
</td></tr>
<tr><td><code id="Scatter+20plots_:_breaks">breaks</code></td>
<td>
<p>a set of finite numeric breakpoints for the colors;
must have one more breakpoint than color and be in increasing order.
Unsorted vectors will be sorted, with a warning.
</p>
</td></tr>
<tr><td><code id="Scatter+20plots_:_colkey">colkey</code></td>
<td>
<p>A logical, <code>NULL</code> (default), or a <code>list</code> with parameters
for the color key (legend). List parameters should be one of 
<code>side, plot, length, width, dist, shift, addlines, col.clab, cex.clab,
      side.clab, line.clab, adj.clab, font.clab</code>
and the axis parameters <code>at, labels, tick, line, pos, outer, font, lty, lwd,
    lwd.ticks, col.box, col.axis, col.ticks, hadj, padj, cex.axis, mgp, tck, tcl, las</code>.
The defaults for the parameters are <code>side = 4, plot = TRUE, length = 1, width = 1, 
      dist = 0, shift = 0, addlines = FALSE, col.clab = NULL, cex.clab = par("cex.lab"), 
      side.clab = NULL, line.clab = NULL, adj.clab = NULL, font.clab = NULL</code>)
See <a href="../../plot3D/help/colkey.html">colkey</a>.
</p>
<p>The default is to draw the color key on side = 4, i.e. in the right margin.
If <code>colkey</code> = <code>NULL</code> then a color key will be added only if <code>col</code> is a vector.
Setting <code>colkey = list(plot = FALSE)</code> will create room for the color key 
without drawing it.
if <code>colkey = FALSE</code>, no color key legend will be added.
</p>
</td></tr> 
<tr><td><code id="Scatter+20plots_:_CI">CI</code></td>
<td>
<p>A <code>list</code> with parameters and values for the confidence 
intervals or <code>NULL</code>.
If a list it should contain at least the item <code>x</code>, <code>y</code> or <code>z</code> 
(latter for <code>scatter3D</code>). These should be 2-columned matrices, defining the left/right intervals. 
Other parameters should be one of (with defaults):
<code>alen = 0.01, lty = par("lty"), lwd = par("lwd"), col = NULL</code>,
to set the length of the arrow head, the line type and width, and the color.
If <code>col</code> is <code>NULL</code>, then the colors as specified by <code>colvar</code> are used.
See examples.
</p>
</td></tr> 
<tr><td><code id="Scatter+20plots_:_panel.first">panel.first</code></td>
<td>
<p>A <code>function</code> to be evaluated after the plot axes are 
set up but before any plotting takes place. 
This can be useful for drawing background grids or scatterplot smooths. 
The function should have as argument the transformation matrix, e.g. it should
be defined as <code>function(pmat)</code>. See example of <a href="../../plot3D/help/persp3D.html">persp3D</a> and last example of <a href="../../plot3D/help/voxel3D.html">voxel3D</a>.
</p>
</td></tr> 
<tr><td><code id="Scatter+20plots_:_clab">clab</code></td>
<td>
<p>Only if <code>colkey</code> is not <code>NULL</code> or <code>FALSE</code>, 
the label to be written on top of the color key. 
The label will be written at the same level as the main title.
To lower it, <code>clab</code> can be made a vector, with the first values empty 
strings. 
</p>
</td></tr> 
<tr><td><code id="Scatter+20plots_:_clim">clim</code></td>
<td>
<p>Only if <code>colvar</code> is specified, the range of the color variable, used
for the color key. Values of <code>colvar</code> that extend the range will be put to <code>NA</code>.
</p>
</td></tr> 
<tr><td><code id="Scatter+20plots_:_bty">bty</code></td>
<td>
<p>The type of the box, the default draws only the back panels.
Only effective if the <a href="../../graphics/html/persp.html">persp</a> 
argument (<code>box</code>) equals <code>TRUE</code> (this is the default). See <a href="../../plot3D/help/perspbox.html">perspbox</a>.
Note: the <code>bty = "g", "b2", "bl"</code> can also be specified 
for <code>scatter2D</code> (if <code>add = FALSE</code>).
</p>
</td></tr>
<tr><td><code id="Scatter+20plots_:_labels">labels</code></td>
<td>
<p>The text to be written. A vector of length equal to length of
x, y, z.
</p>
</td></tr>
<tr><td><code id="Scatter+20plots_:_surf">surf</code></td>
<td>
<p>If not <code>NULL</code>, a list specifying a (fitted) surface to be added on 
the scatterplot. 
The list should include at least <code>x</code>, <code>y</code>, <code>z</code>, defining the surface, 
and optional: <code>colvar, col, NAcol, border, facets, 
    lwd, resfac, clim, ltheta, lphi, shade, lighting, fit</code>. Note that the default is 
that <code>colvar</code> is not specified which will set <code>colvar = z</code>.
The argument <code>fit</code> should give the fitted z-values, in the same order as the 
z-values of the scatter points, for instance produced by <code>predict</code>. 
When present, this will produce droplines from points to the fitted surface.
</p>
</td></tr>
<tr><td><code id="Scatter+20plots_:_add">add</code></td>
<td>
<p>Logical. If <code>TRUE</code>, then the points will be added to the current plot.
If <code>FALSE</code> a new plot is started. 
</p>
</td></tr> 
<tr><td><code id="Scatter+20plots_:_plot">plot</code></td>
<td>
<p>Logical. If <code>TRUE</code> (default), a plot is created, 
otherwise (for 3D plots) the viewing transformation matrix is returned (as invisible). 
</p>
</td></tr> 
<tr><td><code id="Scatter+20plots_:_...">...</code></td>
<td>
<p>additional arguments passed to the plotting methods. 
</p>
<p>The following <a href="../../graphics/html/persp.html">persp</a> arguments can be specified: 
<code>xlim, ylim, zlim, xlab, ylab, zlab, main, sub, r, d, 
    scale, expand, box, axes, nticks, ticktype</code>.      
The arguments <code>xlim</code>, <code>ylim</code>, <code>zlim</code> only affect the axes for 3D plots.
All objects will be plotted, including those that fall out of these ranges.
To select objects only within the axis limits, use <a href="../../plot3D/help/plotdev.html">plotdev</a>.
</p>
<p>In addition, the <a href="../../plot3D/help/perspbox.html">perspbox</a> arguments
<code>col.axis, col.panel, lwd.panel, col.grid, lwd.grid</code> can 
also be given a value.
</p>
<p><code>shade</code> and <code>lighting</code> arguments will have no effect.
</p>
<p><code>alpha</code> can be given a value inbetween 0 and 1 to make colors transparent.
</p>
<p>For all functions, the arguments <code>lty, lwd</code> can be specified; <code>type</code>
can be specified for all except <code>text3D</code>.
</p>
<p>In case <code>type = "p"</code> or <code>"b"</code>, then <code>pch, cex, bg</code> can also be specified.
</p>
<p>The arguments after ... must be matched exactly.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Function <code>scatter3D</code> returns the viewing transformation matrix.
See <a href="../../plot3D/help/trans3D.html">trans3D</a>.
</p>


<h3>Note</h3>

<p>For <code>scatter2D</code> and <code>scatter3D</code> the plottypes that are supported 
are: <code>type = "p"</code>,  <code>type = "l"</code>, <code>type = "h"</code>,
<code>type = "o"</code>. For <code>type = "b"</code>,  <code>type = "o"</code> is used instead.
</p>


<h3>Author(s)</h3>

<p>Karline Soetaert &lt;karline.soetaert@nioz.nl&gt;</p>


<h3>See Also</h3>

<p><a href="../../graphics/html/persp.html">persp</a> for the function on which this implementation is based.
</p>
<p><a href="../../plot3D/help/mesh.html">mesh</a>, <a href="../../plot3D/help/trans3D.html">trans3D</a>, <code>slice3D</code>, for other examples of 
<code>scatter2D</code> or <code>scatter3D</code>.
</p>
<p><a href="../../plot3D/help/plotdev.html">plotdev</a> for zooming, rescaling, rotating a plot.
</p>
<p>package <code>scatterplot3D</code> for an implementation of scatterplots that is 
not based on <code>persp</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># save plotting parameters
 pm &lt;- par("mfrow")

 
## =======================================================================
## A sphere 
## =======================================================================

 par(mfrow = c(1, 1))
 M  &lt;- mesh(seq(0, 2*pi, length.out = 100), 
            seq(0,   pi, length.out = 100))
 u  &lt;- M$x ; v  &lt;- M$y

 x &lt;- cos(u)*sin(v)
 y &lt;- sin(u)*sin(v)
 z &lt;- cos(v)

# full  panels of box are drawn (bty = "f")
 scatter3D(x, y, z, pch = ".", col = "red", 
           bty = "f", cex = 2, colkey = FALSE)

## =======================================================================
## Different types
## =======================================================================

 par (mfrow = c(2, 2))
 z &lt;- seq(0, 10, 0.2)
 x &lt;- cos(z)
 y &lt;- sin(z)*z

# greyish background for the boxtype (bty = "g") 
 scatter3D(x, y, z, phi = 0, bty = "g",
           pch = 20, cex = 2, ticktype = "detailed")
# add another point
 scatter3D(x = 0, y = 0, z = 0, add = TRUE, colkey = FALSE, 
           pch = 18, cex = 3, col = "black")

# add text
 text3D(x = cos(1:10), y = (sin(1:10)*(1:10) - 1), 
        z = 1:10, colkey = FALSE, add = TRUE, 
        labels = LETTERS[1:10], col = c("black", "red"))

# line plot
 scatter3D(x, y, z, phi = 0, bty = "g", type = "l", 
           ticktype = "detailed", lwd = 4)

# points and lines
 scatter3D(x, y, z, phi = 0, bty = "g", type = "b", 
           ticktype = "detailed", pch = 20, 
           cex = c(0.5, 1, 1.5))

# vertical lines
 scatter3D(x, y, z, phi = 0, bty = "g",  type = "h", 
           ticktype = "detailed")

## =======================================================================
## With confidence interval
## =======================================================================

 x &lt;- runif(20)
 y &lt;- runif(20)
 z &lt;- runif(20)

 par(mfrow = c(1, 1))
 CI &lt;- list(z = matrix(nrow = length(x), ncol = 2,
                       data = rep(0.05, times = 2*length(x))))

# greyish background for the boxtype (bty = "g")
 scatter3D(x, y, z, phi = 0, bty = "g", CI = CI,
   col = gg.col(100), pch = 18, cex = 2, ticktype = "detailed",
   xlim = c(0, 1), ylim = c(0, 1), zlim = c(0, 1))

# add new set of points
 x &lt;- runif(20)
 y &lt;- runif(20)
 z &lt;- runif(20)

 CI2 &lt;- list(x = matrix(nrow = length(x), ncol = 2,
                       data = rep(0.05, 2*length(x))),
             z = matrix(nrow = length(x), ncol = 2,
                       data = rep(0.05, 2*length(x))))

 scatter3D(x, y, z, CI = CI2, add = TRUE, col = "red", pch = 16)

## =======================================================================
## With a surface
## =======================================================================

 par(mfrow = c(1, 1))
 
# surface = volcano
 M &lt;- mesh(1:nrow(volcano), 1:ncol(volcano))

# 100 points above volcano 
 N  &lt;- 100
 xs &lt;- runif(N) * 87
 ys &lt;- runif(N) * 61
 zs &lt;- runif(N)*50 + 154
  
# scatter + surface
 scatter3D(xs, ys, zs, ticktype = "detailed", pch = 16, 
   bty = "f", xlim = c(1, 87), ylim = c(1,61), zlim = c(94, 215), 
   surf = list(x = M$x, y = M$y, z = volcano,  
               NAcol = "grey", shade = 0.1))
 
## =======================================================================
## A surface and CI
## =======================================================================

 par(mfrow = c(1, 1))
 M &lt;- mesh(seq(0, 2*pi, length = 30), (1:30)/100)
 z &lt;- with (M, sin(x) + y)
 
# points 'sampled'
 N &lt;- 30
 xs &lt;- runif(N) * 2*pi
 ys &lt;- runif(N) * 0.3

 zs &lt;- sin(xs) + ys + rnorm(N)*0.3
 
 CI &lt;- list(z = matrix(nrow = length(xs), 
                       data = rep(0.3, 2*length(xs))),
            lwd = 3)
  
# facets = NA makes a transparent surface; borders are black
 scatter3D(xs, ys, zs, ticktype = "detailed", pch = 16, 
   xlim = c(0, 2*pi), ylim = c(0, 0.3), zlim = c(-1.5, 1.5), 
   CI = CI, theta = 20, phi = 30, cex = 2,
   surf = list(x = M$x, y = M$y, z = z, border = "black", facets = NA)
   )

## =======================================================================
## droplines till the fitted surface
## =======================================================================

 with (mtcars, {

  # linear regression
   fit &lt;- lm(mpg ~ wt + disp)

  # predict values on regular xy grid
   wt.pred &lt;- seq(1.5, 5.5, length.out = 30)
   disp.pred &lt;- seq(71, 472, length.out = 30)
   xy &lt;- expand.grid(wt = wt.pred, 
                     disp = disp.pred)

   mpg.pred &lt;- matrix (nrow = 30, ncol = 30, 
      data = predict(fit, newdata = data.frame(xy), 
      interval = "prediction")[,1])

# fitted points for droplines to surface
   fitpoints &lt;- predict(fit) 

   scatter3D(z = mpg, x = wt, y = disp, pch = 18, cex = 2, 
      theta = 20, phi = 20, ticktype = "detailed",
      xlab = "wt", ylab = "disp", zlab = "mpg",  
      surf = list(x = wt.pred, y = disp.pred, z = mpg.pred,  
                  facets = NA, fit = fitpoints),
      main = "mtcars")
  
 })

## =======================================================================
## Two ways to make a scatter 3D of quakes data set
## =======================================================================

 par(mfrow = c(1, 1)) 
# first way, use vertical spikes (type = "h")
 with(quakes, scatter3D(x = long, y = lat, z = -depth, colvar = mag, 
      pch = 16, cex = 1.5, xlab = "longitude", ylab = "latitude", 
      zlab = "depth, km", clab = c("Richter","Magnitude"),
      main = "Earthquakes off Fiji", ticktype = "detailed", 
      type = "h", theta = 10, d = 2, 
      colkey = list(length = 0.5, width = 0.5, cex.clab = 0.75))
      )

# second way: add dots on bottom and left panel
# before the scatters are drawn, 
# add small dots on basal plane and on the depth plane
 panelfirst &lt;- function(pmat) {
    zmin &lt;- min(-quakes$depth)
    XY &lt;- trans3D(quakes$long, quakes$lat, 
                  z = rep(zmin, nrow(quakes)), pmat = pmat)
    scatter2D(XY$x, XY$y, colvar = quakes$mag, pch = ".", 
            cex = 2, add = TRUE, colkey = FALSE)
 
    xmin &lt;- min(quakes$long)
    XY &lt;- trans3D(x = rep(xmin, nrow(quakes)), y = quakes$lat, 
                  z = -quakes$depth, pmat = pmat)
    scatter2D(XY$x, XY$y, colvar = quakes$mag, pch = ".", 
            cex = 2, add = TRUE, colkey = FALSE)
 }

 with(quakes, scatter3D(x = long, y = lat, z = -depth, colvar = mag, 
      pch = 16, cex = 1.5, xlab = "longitude", ylab = "latitude", 
      zlab = "depth, km", clab = c("Richter","Magnitude"),
      main = "Earthquakes off Fiji", ticktype = "detailed", 
      panel.first = panelfirst, theta = 10, d = 2, 
      colkey = list(length = 0.5, width = 0.5, cex.clab = 0.75))
      )

## =======================================================================
## text3D and scatter3D
## =======================================================================

 with(USArrests, text3D(Murder, Assault, Rape, 
    colvar = UrbanPop, col = gg.col(100), theta = 60, phi = 20,
    xlab = "Murder", ylab = "Assault", zlab = "Rape", 
    main = "USA arrests", 
    labels = rownames(USArrests), cex = 0.6, 
    bty = "g", ticktype = "detailed", d = 2,
    clab = c("Urban","Pop"), adj = 0.5, font = 2))

 with(USArrests, scatter3D(Murder, Assault, Rape - 1, 
    colvar = UrbanPop, col = gg.col(100), 
    type = "h", pch = ".", add = TRUE))

## =======================================================================
## zoom near origin
## =======================================================================

# display axis ranges
 getplist()[c("xlim","ylim","zlim")] 

# choose suitable ranges
 plotdev(xlim = c(0, 10), ylim = c(40, 150), 
         zlim = c(7, 25))

## =======================================================================
## text3D to label x- and y axis
## =======================================================================

 par(mfrow = c(1, 1))
 hist3D (x = 1:5, y = 1:4, z = VADeaths,
        bty = "g", phi = 20,  theta = -60,
        xlab = "", ylab = "", zlab = "", main = "VADeaths",
        col = "#0072B2", border = "black", shade = 0.8,
        ticktype = "detailed", space = 0.15, d = 2, cex.axis = 1e-9)

 text3D(x = 1:5, y = rep(0.5, 5), z = rep(3, 5),
       labels = rownames(VADeaths),
       add = TRUE, adj = 0)
 text3D(x = rep(1, 4),   y = 1:4, z = rep(0, 4),
       labels  = colnames(VADeaths),
       add = TRUE, adj = 1)

## =======================================================================
## Scatter2D; bty can also be set = to one of the perspbox alernatives
## =======================================================================

 par(mfrow = c(2, 2))
 x &lt;- seq(0, 2*pi, length.out = 30)

 scatter2D(x, sin(x), colvar = cos(x), pch = 16, 
         ylab = "sin", clab = "cos", cex = 1.5)
# other box types:
 scatter2D(x, sin(x), colvar = cos(x), type = "l", lwd = 4, bty = "g")
 scatter2D(x, sin(x), colvar = cos(x), type = "b", lwd = 2, bty = "b2")
# transparent colors and spikes
 scatter2D(x, sin(x), colvar = cos(x), type = "h", lwd = 4, alpha = 0.5)
  
## =======================================================================
## mesh examples and scatter2D
## =======================================================================

 par(mfrow = c(1, 2))
 x &lt;- seq(-1, 1, by = 0.1)
 y &lt;- seq(-2, 2, by = 0.2)

 grid &lt;- mesh(x, y)
 z    &lt;- with(grid, cos(x) * sin(y))
 image2D(z, x = x, y = y)
 points(grid)
 scatter2D(grid$x, grid$y, colvar = z, pch = 20, cex = 2)

## =======================================================================
## scatter plot with confidence intervals
## =======================================================================

 par(mfrow = c(2, 2))
 x  &lt;- sort(rnorm(10)) 
 y  &lt;- runif(10)
 cv &lt;- sqrt(x^2 + y^2)

 CI &lt;- list(lwd = 2)
 CI$x &lt;- matrix (nrow = length(x), ncol = 2, data = rep(0.25, 2*length(x)))
 scatter2D(x, y, colvar = cv, pch = 16, cex = 2, CI = CI)
 scatter2D(x, y, colvar = cv, pch = 16, cex = 2, CI = CI, type = "b")

 CI$y &lt;- matrix (nrow = length(x), ncol = 2, data = rep(0.05, 2*length(x)))
 CI$col &lt;- "black"
 scatter2D(x, y, colvar = cv, pch = 16, cex = 2, CI = CI)

 CI$y[c(2,4,8,10), ] &lt;- NA  # Some points have no CI
 CI$x[c(2,4,8,10), ] &lt;- NA  # Some points have no CI
 CI$alen &lt;- 0.02            # increase arrow head
 scatter2D(x, y, colvar = cv, pch = 16, cex = 2, CI = CI)

## =======================================================================
## Scatter on an image
## =======================================================================
 
 par(mfrow = c(1, 1))
# image of oxygen saturation
 oxlim &lt;- range(Oxsat$val[,,1], na.rm  = TRUE) 
 image2D(z = Oxsat$val[,,1], x = Oxsat$lon, y = Oxsat$lat,
       contour = TRUE, 
       xlab = "longitude", ylab = "latitude", 
       main = "Oxygen saturation", clim = oxlim, clab = "%")

# (imaginary) measurements at 5 sites
 lon   &lt;- c( 11.2,   6.0, 0.9,  -4, -8.8)
 lat   &lt;- c(-19.7,-14.45,-9.1,-3.8, -1.5)
 O2sat &lt;- c(   90,    95,  92,  85,  100)
               
# add to image; use same zrange; avoid adding  a color key
 scatter2D(colvar = O2sat, x = lon, y = lat, clim = oxlim, pch = 16,
         add = TRUE, cex = 2, colkey = FALSE)

## =======================================================================
## Scatter on a contourplot
## =======================================================================

 par(mfrow = c(1, 1))

# room for colorkey by setting colkey = list(plot = FALSE)

# contour plot of the ocean's bathymetry
 Depth &lt;- Hypsometry$z
 Depth[Depth &gt; 0] &lt;- NA
 contour2D(z = Depth, x = Hypsometry$x, y = Hypsometry$y, 
       xlab = "longitude", ylab = "latitude", 
       col = "black", NAcol = "grey", levels = seq(-6000, 0, by = 2000),
       main = "Oxygen saturation along ship track", 
       colkey = list(plot = FALSE))

# add data to image; with  a color key
 scatter2D(colvar = O2sat, x = lon, y = lat, pch = 16,
         add = TRUE, cex = 2, clab = "%")

## =======================================================================
## scatter2D for time-series plots
## =======================================================================

# Plotting sunspot 'anomalies'
sunspot &lt;- data.frame(year = time(sunspot.month), 
  anom = sunspot.month - mean(sunspot.month))

# long-term moving average of anomaly
ff &lt;- 100
sunspot$ma &lt;- filter(sunspot$anom, rep(1/ff, ff), sides = 2)

with (sunspot, lines2D(year, anom, 
  colvar = anom &gt; 0, 
  col = c("pink", "lightblue"),
  main = "sunspot anomaly", type = "h", 
  colkey = FALSE, las = 1, xlab = "year", ylab = ""))
lines2D(sunspot$year, sunspot$ma, add = TRUE)  

# The same
#with (sunspot, plot(year, anom, 
#  col = c("pink", "lightblue")[(anom &gt; 0) + 1],
#  main = "sunspot", type = "h", las = 1))

# but this does not work due to NAs...  
# lines(sunspot$year, sunspot$ma)  

## =======================================================================
## text2D
## =======================================================================

 with(USArrests, text2D(x = Murder, y = Assault + 5, colvar = Rape, 
     xlab = "Murder", ylab = "Assault", clab = "Rape", 
     main = "USA arrests", labels = rownames(USArrests), cex = 0.6, 
     adj = 0.5, font = 2))

 with(USArrests, scatter2D(x = Murder, y = Assault, colvar = Rape, 
     pch = 16, add = TRUE, colkey = FALSE))

# reset plotting parameters
 par(mfrow = pm)
</code></pre>

<hr /><div style="text-align: center;">[Package <em>plot3D</em> version 1.4 <a href="00Index.html">Index</a>]</div>
</div>
</body></html>
