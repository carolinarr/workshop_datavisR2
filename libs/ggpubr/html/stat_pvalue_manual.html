<!DOCTYPE html><html><head><title>R: Add Manually P-values to a ggplot</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body><div class="container">

<table style="width: 100%;"><tr><td>stat_pvalue_manual {ggpubr}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2 id='stat_pvalue_manual'>Add Manually P-values to a ggplot</h2>

<h3>Description</h3>

<p>Add manually p-values to a ggplot, such as box blots, dot plots
and stripcharts. Frequently asked questions are available on <a href="https://www.datanovia.com/en/blog/tag/ggpubr/">Datanovia ggpubr FAQ page</a>, for example:
</p>

<ul>
<li> <p><a href="https://www.datanovia.com/en/blog/how-to-add-p-values-onto-basic-ggplots/">How to Add P-Values onto Basic GGPLOTS</a>
</p>
</li>
<li> <p><a href="https://www.datanovia.com/en/blog/ggpubr-how-to-add-adjusted-p-values-to-a-multi-panel-ggplot/">How to Add Adjusted P-values to a Multi-Panel GGPlot</a>
</p>
</li>
<li> <p><a href="https://www.datanovia.com/en/blog/how-to-add-p-values-to-ggplot-facets/">How to Add P-values to GGPLOT Facets</a>
</p>
</li>
<li> <p><a href="https://www.datanovia.com/en/blog/ggpubr-how-to-add-p-values-generated-elsewhere-to-a-ggplot/">How to Add P-Values Generated Elsewhere to a GGPLOT</a>
</p>
</li>
<li> <p><a href="https://www.datanovia.com/en/blog/how-to-add-p-values-onto-a-grouped-ggplot-using-the-ggpubr-r-package/">How to Add P-Values onto a Grouped GGPLOT using the GGPUBR R Package</a>
</p>
</li>
<li> <p><a href="https://www.datanovia.com/en/blog/how-to-create-stacked-bar-plots-with-error-bars-and-p-values/">How to Create Stacked Bar Plots with Error Bars and P-values</a>
</p>
</li>
<li> <p><a href="https://www.datanovia.com/en/blog/how-to-add-p-values-onto-horizontal-ggplots/">How to Add P-Values onto Horizontal GGPLOTS</a>
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>stat_pvalue_manual(
  data,
  label = NULL,
  y.position = "y.position",
  xmin = "group1",
  xmax = "group2",
  x = NULL,
  size = 3.88,
  label.size = size,
  bracket.size = 0.3,
  bracket.nudge.y = 0,
  bracket.shorten = 0,
  color = "black",
  linetype = 1,
  tip.length = 0.03,
  remove.bracket = FALSE,
  step.increase = 0,
  step.group.by = NULL,
  hide.ns = FALSE,
  vjust = 0,
  coord.flip = FALSE,
  position = "identity",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stat_pvalue_manual_:_data">data</code></td>
<td>
<p>a data frame containing statitistical test results. The expected
default format should contain the following columns: <code>group1 | group2 |
p | y.position | etc</code>. <code>group1</code> and <code>group2</code> are the groups that
have been compared. <code>p</code> is the resulting p-value. <code>y.position</code> is
the y coordinates of the p-values in the plot.</p>
</td></tr>
<tr><td><code id="stat_pvalue_manual_:_label">label</code></td>
<td>
<p>the column containing the label (e.g.: label = &quot;p&quot; or label =
&quot;p.adj&quot;), where <code>p</code> is the p-value. Can be also an expression that can
be formatted by the <code><a href="../../glue/help/glue.html">glue</a>()</code> package. For example, when
specifying label = &quot;t-test, p = {p}&quot;, the expression {p} will be
replaced by its value.</p>
</td></tr>
<tr><td><code id="stat_pvalue_manual_:_y.position">y.position</code></td>
<td>
<p>column containing the coordinates (in data units) to be used
for absolute positioning of the label. Default value is &quot;y.position&quot;. Can be
also a numeric vector.</p>
</td></tr>
<tr><td><code id="stat_pvalue_manual_:_xmin">xmin</code></td>
<td>
<p>column containing the position of the left sides of the brackets.
Default value is &quot;group1&quot;.</p>
</td></tr>
<tr><td><code id="stat_pvalue_manual_:_xmax">xmax</code></td>
<td>
<p>(optional) column containing the position of the right sides of
the brackets. Default value is &quot;group2&quot;. If NULL, the p-values are plotted
as a simple text.</p>
</td></tr>
<tr><td><code id="stat_pvalue_manual_:_x">x</code></td>
<td>
<p>x position of the p-value. Should be used only when you want plot the
p-value as text (without brackets).</p>
</td></tr>
<tr><td><code id="stat_pvalue_manual_:_size">size</code>, <code id="stat_pvalue_manual_:_label.size">label.size</code></td>
<td>
<p>size of label text.</p>
</td></tr>
<tr><td><code id="stat_pvalue_manual_:_bracket.size">bracket.size</code></td>
<td>
<p>Width of the lines of the bracket.</p>
</td></tr>
<tr><td><code id="stat_pvalue_manual_:_bracket.nudge.y">bracket.nudge.y</code></td>
<td>
<p>Vertical adjustment to nudge brackets by. Useful to
move up or move down the bracket. If positive value, brackets will be moved
up; if negative value, brackets are moved down.</p>
</td></tr>
<tr><td><code id="stat_pvalue_manual_:_bracket.shorten">bracket.shorten</code></td>
<td>
<p>a small numeric value in [0-1] for shortening the with
of bracket.</p>
</td></tr>
<tr><td><code id="stat_pvalue_manual_:_color">color</code></td>
<td>
<p>text and line color. Can be variable name in the data for coloring by groups.</p>
</td></tr>
<tr><td><code id="stat_pvalue_manual_:_linetype">linetype</code></td>
<td>
<p>linetype. Can be variable name in the data for changing linetype by groups.</p>
</td></tr>
<tr><td><code id="stat_pvalue_manual_:_tip.length">tip.length</code></td>
<td>
<p>numeric vector with the fraction of total height that the
bar goes down to indicate the precise column. Default is 0.03.</p>
</td></tr>
<tr><td><code id="stat_pvalue_manual_:_remove.bracket">remove.bracket</code></td>
<td>
<p>logical, if <code>TRUE</code>, brackets are removed from the
plot. Considered only in the situation, where comparisons are performed
against reference group or against &quot;all&quot;.</p>
</td></tr>
<tr><td><code id="stat_pvalue_manual_:_step.increase">step.increase</code></td>
<td>
<p>numeric vector with the increase in fraction of total
height for every additional comparison to minimize overlap.</p>
</td></tr>
<tr><td><code id="stat_pvalue_manual_:_step.group.by">step.group.by</code></td>
<td>
<p>a variable name for grouping brackets before adding
step.increase. Useful to group bracket by facet panel.</p>
</td></tr>
<tr><td><code id="stat_pvalue_manual_:_hide.ns">hide.ns</code></td>
<td>
<p>can be logical value or a character vector.
</p>

<ul>
<li><p> Case when logical value. If TRUE, hide ns symbol when displaying
significance levels. Filter is done by checking the column
<code>p.adj.signif</code>, <code>p.signif</code>, <code>p.adj</code> and <code>p</code>.
</p>
</li>
<li><p> Case when character value. Possible values are &quot;p&quot; or &quot;p.adj&quot;, for filtering out non significant.
</p>
</li></ul>
</td></tr>
<tr><td><code id="stat_pvalue_manual_:_vjust">vjust</code></td>
<td>
<p>move the text up or down relative to the bracket. Can be also a
column name available in the data.</p>
</td></tr>
<tr><td><code id="stat_pvalue_manual_:_coord.flip">coord.flip</code></td>
<td>
<p>logical. If <code>TRUE</code>, flip x and y coordinates so that
horizontal becomes vertical, and vertical, horizontal. When adding the
p-values to a horizontal ggplot (generated using
<code><a href="../../ggplot2/help/coord_flip.html">coord_flip</a>()</code>), you need to specify the option
<code>coord.flip = TRUE</code>.</p>
</td></tr>
<tr><td><code id="stat_pvalue_manual_:_position">position</code></td>
<td>
<p>position adjustment, either as a string, or the result of a
call to a position adjustment function.</p>
</td></tr>
<tr><td><code id="stat_pvalue_manual_:_...">...</code></td>
<td>
<p>other arguments passed to the function <code>geom_bracket()</code> or
<code>geom_text()</code></p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="../../ggpubr/help/stat_compare_means.html">stat_compare_means</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# T-test
stat.test &lt;- compare_means(
 len ~ dose, data = ToothGrowth,
 method = "t.test"
)
stat.test

# Create a simple box plot
p &lt;- ggboxplot(ToothGrowth, x = "dose", y = "len")
p

# Perform a t-test between groups
stat.test &lt;- compare_means(
 len ~ dose, data = ToothGrowth,
 method = "t.test"
)
stat.test

# Add manually p-values from stat.test data
# First specify the y.position of each comparison
stat.test &lt;- stat.test %&gt;%
 mutate(y.position = c(29, 35, 39))
p + stat_pvalue_manual(stat.test, label = "p.adj")

# Customize the label with glue expression
# (https://github.com/tidyverse/glue)
p + stat_pvalue_manual(stat.test, label = "p = {p.adj}")


# Grouped bar plots
#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
ToothGrowth$dose &lt;- as.factor(ToothGrowth$dose)
# Comparisons against reference
stat.test &lt;- compare_means(
  len ~ dose, data = ToothGrowth, group.by = "supp",
  method = "t.test", ref.group = "0.5"
)
stat.test
# Plot
bp &lt;- ggbarplot(ToothGrowth, x = "supp", y = "len",
                fill = "dose", palette = "jco",
                add = "mean_sd", add.params = list(group = "dose"),
                position = position_dodge(0.8))
bp + stat_pvalue_manual(
  stat.test, x = "supp", y.position = 33,
  label = "p.signif",
  position = position_dodge(0.8)
)

</code></pre>

<hr /><div style="text-align: center;">[Package <em>ggpubr</em> version 0.6.0 <a href="00Index.html">Index</a>]</div>
</div>
</body></html>
